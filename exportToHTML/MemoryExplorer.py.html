<html>
<head>
<title>MemoryExplorer.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #7a7e85;}
.s4 { color: #2aacb8;}
.s5 { color: #6aab73;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
MemoryExplorer.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">direct</span><span class="s2">.</span><span class="s1">showbase</span><span class="s2">.</span><span class="s1">DirectObject </span><span class="s0">import </span><span class="s1">DirectObject</span>
<span class="s0">from </span><span class="s1">direct</span><span class="s2">.</span><span class="s1">showbase</span><span class="s2">.</span><span class="s1">TkGlobal </span><span class="s0">import </span><span class="s2">*</span>
<span class="s0">from </span><span class="s2">.</span><span class="s1">Tree </span><span class="s0">import </span><span class="s2">*</span>
<span class="s0">import </span><span class="s1">Pmw</span>

<span class="s3">#--------------------------------------------------------------------------</span>
<span class="s3">#--------------------------------------------------------------------------</span>
<span class="s1">DEFAULT_BT_WIDTH </span><span class="s2">= </span><span class="s4">50.0</span>

<span class="s3">#--------------------------------------------------------------------------</span>
<span class="s3">#--------------------------------------------------------------------------</span>
<span class="s0">class </span><span class="s1">MemoryExplorer</span><span class="s2">(</span><span class="s1">Pmw</span><span class="s2">.</span><span class="s1">MegaWidget</span><span class="s2">, </span><span class="s1">DirectObject</span><span class="s2">):</span>

    <span class="s3">#--------------------------------------------------------------------------</span>
    <span class="s3"># Init</span>
    <span class="s3">#--------------------------------------------------------------------------</span>
    <span class="s0">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">parent </span><span class="s2">= </span><span class="s0">None</span><span class="s2">, </span><span class="s1">nodePath </span><span class="s2">= </span><span class="s0">None</span><span class="s2">, **</span><span class="s1">kw</span><span class="s2">):</span>
        <span class="s0">if </span><span class="s1">nodePath </span><span class="s0">is None</span><span class="s2">:</span>
            <span class="s1">nodePath </span><span class="s2">= </span><span class="s1">render</span>

        <span class="s1">optiondefs </span><span class="s2">= ((</span><span class="s5">'menuItems'</span><span class="s2">,   [],   </span><span class="s1">Pmw</span><span class="s2">.</span><span class="s1">INITOPT</span><span class="s2">),)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">defineoptions</span><span class="s2">(</span><span class="s1">kw</span><span class="s2">, </span><span class="s1">optiondefs</span><span class="s2">)</span>
        <span class="s1">Pmw</span><span class="s2">.</span><span class="s1">MegaWidget</span><span class="s2">.</span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">parent</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">nodePath </span><span class="s2">= </span><span class="s1">nodePath</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">renderItem </span><span class="s2">= </span><span class="s0">None</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">render2dItem </span><span class="s2">= </span><span class="s0">None</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">buttons </span><span class="s2">= []</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">labels </span><span class="s2">= []</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">rootItem </span><span class="s2">= </span><span class="s0">None</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">btWidth </span><span class="s2">= </span><span class="s1">DEFAULT_BT_WIDTH</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">createScrolledFrame</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">createScale</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">createRefreshBT</span><span class="s2">()</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">balloon </span><span class="s2">= </span><span class="s1">Pmw</span><span class="s2">.</span><span class="s1">Balloon</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">interior</span><span class="s2">())</span>

    <span class="s0">def </span><span class="s1">createScrolledFrame</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">frame </span><span class="s2">= </span><span class="s1">Pmw</span><span class="s2">.</span><span class="s1">ScrolledFrame</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">interior</span><span class="s2">(),</span>
                                       <span class="s1">labelpos </span><span class="s2">= </span><span class="s5">'n'</span><span class="s2">,</span>
                                       <span class="s1">label_text </span><span class="s2">= </span><span class="s5">'ScrolledFrame'</span><span class="s2">,</span>
                                       <span class="s1">usehullsize </span><span class="s2">= </span><span class="s4">1</span><span class="s2">,</span>
                                       <span class="s1">hull_width </span><span class="s2">= </span><span class="s4">200</span><span class="s2">,</span>
                                       <span class="s1">hull_height </span><span class="s2">= </span><span class="s4">220</span><span class="s2">,)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">padx </span><span class="s2">= </span><span class="s4">3</span><span class="s2">, </span><span class="s1">pady </span><span class="s2">= </span><span class="s4">3</span><span class="s2">, </span><span class="s1">fill </span><span class="s2">= </span><span class="s1">BOTH</span><span class="s2">, </span><span class="s1">expand </span><span class="s2">= </span><span class="s4">1</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">createScale</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">scaleCtrl </span><span class="s2">= </span><span class="s1">Scale</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">interior</span><span class="s2">(),</span>
                               <span class="s1">label </span><span class="s2">= </span><span class="s5">&quot;Graph Scale&quot;</span><span class="s2">,</span>
                               <span class="s1">from_</span><span class="s2">= </span><span class="s4">0.0</span><span class="s2">,</span>
                               <span class="s1">to </span><span class="s2">= </span><span class="s4">20.0</span><span class="s2">,</span>
                               <span class="s1">resolution </span><span class="s2">= </span><span class="s4">0.1</span><span class="s2">,</span>
                               <span class="s1">orient </span><span class="s2">= </span><span class="s1">HORIZONTAL</span><span class="s2">,</span>
                               <span class="s1">command </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">onScaleUpdate</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">scaleCtrl</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side </span><span class="s2">= </span><span class="s1">LEFT</span><span class="s2">, </span><span class="s1">fill </span><span class="s2">= </span><span class="s1">BOTH</span><span class="s2">, </span><span class="s1">expand </span><span class="s2">= </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">scaleCtrl</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s4">0.0</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">createRefreshBT</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">refreshBT </span><span class="s2">= </span><span class="s1">Button</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">interior</span><span class="s2">(), </span><span class="s1">text </span><span class="s2">= </span><span class="s5">'Refresh'</span><span class="s2">, </span><span class="s1">command </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">refresh</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">refreshBT</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side </span><span class="s2">= </span><span class="s1">LEFT</span><span class="s2">, </span><span class="s1">fill </span><span class="s2">= </span><span class="s1">BOTH</span><span class="s2">, </span><span class="s1">expand </span><span class="s2">= </span><span class="s4">1</span><span class="s2">)</span>

    <span class="s3">#--------------------------------------------------------------------------</span>
    <span class="s3"># Item Ctrls</span>
    <span class="s3">#--------------------------------------------------------------------------</span>
    <span class="s0">def </span><span class="s1">createDefaultCtrls</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">renderItem </span><span class="s2">== </span><span class="s0">None or </span><span class="s1">self</span><span class="s2">.</span><span class="s1">render2dItem </span><span class="s2">== </span><span class="s0">None</span><span class="s2">:</span>
            <span class="s0">return</span>

        <span class="s1">totalBytes </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">renderItem</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">()+</span><span class="s1">self</span><span class="s2">.</span><span class="s1">render2dItem</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">()</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">addChildCtrl</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">renderItem</span><span class="s2">, </span><span class="s1">totalBytes</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">addChildCtrl</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">render2dItem</span><span class="s2">, </span><span class="s1">totalBytes</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">setTitle</span><span class="s2">(</span><span class="s5">&quot;ALL&quot;</span><span class="s2">, </span><span class="s1">totalBytes</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">setTitle</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">parent</span><span class="s2">, </span><span class="s1">bytes</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">[</span><span class="s5">&quot;label_text&quot;</span><span class="s2">] = </span><span class="s5">&quot;[%s] - %s bytes&quot; </span><span class="s2">% (</span><span class="s1">parent</span><span class="s2">, </span><span class="s1">bytes</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">resetCtrls</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">button </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">buttons</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">balloon</span><span class="s2">.</span><span class="s1">unbind</span><span class="s2">(</span><span class="s1">button</span><span class="s2">)</span>
            <span class="s1">button</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">buttons </span><span class="s2">= []</span>

        <span class="s0">for </span><span class="s1">label </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">labels</span><span class="s2">:</span>
            <span class="s1">label</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">labels </span><span class="s2">= []</span>

    <span class="s0">def </span><span class="s1">getNewButton</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">width</span><span class="s2">, </span><span class="s1">ratio</span><span class="s2">):</span>
        <span class="s1">newBT </span><span class="s2">=  </span><span class="s1">Button</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">.</span><span class="s1">interior</span><span class="s2">(),</span>
                        <span class="s1">anchor </span><span class="s2">= </span><span class="s1">W</span><span class="s2">,</span>
                        <span class="s1">width </span><span class="s2">= </span><span class="s1">width</span><span class="s2">)</span>

        <span class="s0">if </span><span class="s1">ratio </span><span class="s2">== </span><span class="s4">0.0</span><span class="s2">:</span>
            <span class="s1">newBT</span><span class="s2">[</span><span class="s5">'bg'</span><span class="s2">] = </span><span class="s5">&quot;grey&quot;</span>
            <span class="s1">newBT</span><span class="s2">[</span><span class="s5">'text'</span><span class="s2">] = </span><span class="s5">&quot;.&quot;</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">newBT</span><span class="s2">[</span><span class="s5">'bg'</span><span class="s2">] = </span><span class="s1">Pmw</span><span class="s2">.</span><span class="s1">Color</span><span class="s2">.</span><span class="s1">hue2name</span><span class="s2">(</span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">-</span><span class="s1">ratio</span><span class="s2">)</span>
            <span class="s1">newBT</span><span class="s2">[</span><span class="s5">'text'</span><span class="s2">] = </span><span class="s5">&quot;%0.2f%%&quot; </span><span class="s2">% (</span><span class="s1">ratio</span><span class="s2">*</span><span class="s4">100.0</span><span class="s2">)</span>

        <span class="s0">return </span><span class="s1">newBT</span>

    <span class="s0">def </span><span class="s1">addSelfCtrl</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">item</span><span class="s2">, </span><span class="s1">totalBytes</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">addLabel</span><span class="s2">(</span><span class="s5">&quot;[self] : %s bytes&quot; </span><span class="s2">% </span><span class="s1">item</span><span class="s2">.</span><span class="s1">getSelfVertexBytes</span><span class="s2">())</span>

        <span class="s1">bt </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">addButton</span><span class="s2">(</span><span class="s1">item</span><span class="s2">.</span><span class="s1">getSelfVertexBytes</span><span class="s2">(),</span>
                            <span class="s1">totalBytes</span><span class="s2">,</span>
                            <span class="s1">self</span><span class="s2">.</span><span class="s1">onSelfButtonLClick</span><span class="s2">,</span>
                            <span class="s1">self</span><span class="s2">.</span><span class="s1">onSelfButtonRClick</span><span class="s2">,</span>
                            <span class="s1">item</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">addChildCtrl</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">item</span><span class="s2">, </span><span class="s1">totalBytes</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">addLabel</span><span class="s2">(</span><span class="s5">&quot;%s [+%s] : %s bytes&quot; </span><span class="s2">% (</span><span class="s1">item</span><span class="s2">.</span><span class="s1">getName</span><span class="s2">(),</span>
                                                <span class="s1">item</span><span class="s2">.</span><span class="s1">getNumChildren</span><span class="s2">(),</span>
                                                <span class="s1">item</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">()))</span>

        <span class="s1">bt </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">addButton</span><span class="s2">(</span><span class="s1">item</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">(),</span>
                            <span class="s1">totalBytes</span><span class="s2">,</span>
                            <span class="s1">self</span><span class="s2">.</span><span class="s1">onChildButtonLClick</span><span class="s2">,</span>
                            <span class="s1">self</span><span class="s2">.</span><span class="s1">onChildButtonRClick</span><span class="s2">,</span>
                            <span class="s1">item</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">addButton</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">vertexBytes</span><span class="s2">, </span><span class="s1">totalBytes</span><span class="s2">, </span><span class="s1">funcLClick</span><span class="s2">, </span><span class="s1">funcRClick</span><span class="s2">, </span><span class="s1">item</span><span class="s2">):</span>
        <span class="s1">width </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">getBTWidth</span><span class="s2">(</span><span class="s1">vertexBytes</span><span class="s2">, </span><span class="s1">totalBytes</span><span class="s2">)</span>

        <span class="s0">if </span><span class="s1">totalBytes </span><span class="s2">== </span><span class="s4">0</span><span class="s2">:</span>
            <span class="s1">ratio </span><span class="s2">= </span><span class="s4">0.0</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">ratio </span><span class="s2">= </span><span class="s1">vertexBytes</span><span class="s2">/</span><span class="s1">float</span><span class="s2">(</span><span class="s1">totalBytes</span><span class="s2">)</span>

        <span class="s1">bt </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">getNewButton</span><span class="s2">(</span><span class="s1">width</span><span class="s2">, </span><span class="s1">ratio</span><span class="s2">)</span>

        <span class="s0">def </span><span class="s1">callbackL</span><span class="s2">(</span><span class="s1">event</span><span class="s2">):</span>
            <span class="s1">funcLClick</span><span class="s2">(</span><span class="s1">item</span><span class="s2">)</span>

        <span class="s0">def </span><span class="s1">callbackR</span><span class="s2">(</span><span class="s1">event</span><span class="s2">):</span>
            <span class="s1">funcRClick</span><span class="s2">(</span><span class="s1">item</span><span class="s2">)</span>

        <span class="s1">bt</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s5">&quot;&lt;Button-1&gt;&quot;</span><span class="s2">, </span><span class="s1">callbackL</span><span class="s2">)</span>
        <span class="s1">bt</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s5">&quot;&lt;Button-3&gt;&quot;</span><span class="s2">, </span><span class="s1">callbackR</span><span class="s2">)</span>

        <span class="s1">bt</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side </span><span class="s2">= </span><span class="s1">TOP</span><span class="s2">, </span><span class="s1">anchor </span><span class="s2">= </span><span class="s1">NW</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">buttons</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">bt</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">balloon</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s1">bt</span><span class="s2">, </span><span class="s1">item</span><span class="s2">.</span><span class="s1">getPathName</span><span class="s2">())</span>

        <span class="s0">return </span><span class="s1">bt</span>

    <span class="s0">def </span><span class="s1">addLabel</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">label</span><span class="s2">):</span>
        <span class="s1">label </span><span class="s2">= </span><span class="s1">Label</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">frame</span><span class="s2">.</span><span class="s1">interior</span><span class="s2">(), </span><span class="s1">text </span><span class="s2">= </span><span class="s1">label</span><span class="s2">)</span>
        <span class="s1">label</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side </span><span class="s2">= </span><span class="s1">TOP</span><span class="s2">, </span><span class="s1">anchor </span><span class="s2">= </span><span class="s1">NW</span><span class="s2">,  </span><span class="s1">expand </span><span class="s2">= </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">labels</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">label</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">getBTWidth</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">vertexBytes</span><span class="s2">, </span><span class="s1">totalBytes</span><span class="s2">):</span>
        <span class="s0">if </span><span class="s1">totalBytes </span><span class="s2">== </span><span class="s4">0</span><span class="s2">:</span>
            <span class="s0">return </span><span class="s4">1</span>

        <span class="s1">width </span><span class="s2">= </span><span class="s1">int</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">btWidth </span><span class="s2">* </span><span class="s1">vertexBytes </span><span class="s2">/ </span><span class="s1">totalBytes</span><span class="s2">)</span>

        <span class="s0">if </span><span class="s1">width </span><span class="s2">== </span><span class="s4">0</span><span class="s2">:</span>
            <span class="s1">width </span><span class="s2">= </span><span class="s4">1</span>

        <span class="s0">return </span><span class="s1">width</span>

    <span class="s3">#--------------------------------------------------------------------------</span>
    <span class="s3"># Callback</span>
    <span class="s3">#--------------------------------------------------------------------------</span>
    <span class="s0">def </span><span class="s1">onScaleUpdate</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">arg</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">btWidth </span><span class="s2">= </span><span class="s1">DEFAULT_BT_WIDTH </span><span class="s2">+  </span><span class="s1">DEFAULT_BT_WIDTH </span><span class="s2">* </span><span class="s1">float</span><span class="s2">(</span><span class="s1">arg</span><span class="s2">)</span>

        <span class="s0">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rootItem</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">updateBTWidth</span><span class="s2">()</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">updateDefaultBTWidth</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">updateBTWidth</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">buttons</span><span class="s2">[</span><span class="s4">0</span><span class="s2">][</span><span class="s5">'width'</span><span class="s2">] = </span><span class="s1">self</span><span class="s2">.</span><span class="s1">getBTWidth</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rootItem</span><span class="s2">.</span><span class="s1">getSelfVertexBytes</span><span class="s2">(),</span>
                                                   <span class="s1">self</span><span class="s2">.</span><span class="s1">rootItem</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">())</span>

        <span class="s1">btIndex </span><span class="s2">= </span><span class="s4">1</span>
        <span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rootItem</span><span class="s2">.</span><span class="s1">getChildren</span><span class="s2">():</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">buttons</span><span class="s2">[</span><span class="s1">btIndex</span><span class="s2">][</span><span class="s5">'width'</span><span class="s2">] = </span><span class="s1">self</span><span class="s2">.</span><span class="s1">getBTWidth</span><span class="s2">(</span><span class="s1">item</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">(),</span>
                                                             <span class="s1">self</span><span class="s2">.</span><span class="s1">rootItem</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">())</span>
            <span class="s1">btIndex </span><span class="s2">+= </span><span class="s4">1</span>

    <span class="s0">def </span><span class="s1">updateDefaultBTWidth</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">renderItem </span><span class="s2">== </span><span class="s0">None or </span><span class="s1">self</span><span class="s2">.</span><span class="s1">render2dItem </span><span class="s2">== </span><span class="s0">None</span><span class="s2">:</span>
            <span class="s0">return</span>
        <span class="s1">totalBytes </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">renderItem</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">() + </span><span class="s1">self</span><span class="s2">.</span><span class="s1">render2dItem</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">buttons</span><span class="s2">[</span><span class="s4">0</span><span class="s2">][</span><span class="s5">'width'</span><span class="s2">] = </span><span class="s1">self</span><span class="s2">.</span><span class="s1">getBTWidth</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">renderItem</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">(), </span><span class="s1">totalBytes</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">buttons</span><span class="s2">[</span><span class="s4">1</span><span class="s2">][</span><span class="s5">'width'</span><span class="s2">] = </span><span class="s1">self</span><span class="s2">.</span><span class="s1">getBTWidth</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">render2dItem</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">(), </span><span class="s1">totalBytes</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">onSelfButtonLClick</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">item</span><span class="s2">):</span>
        <span class="s0">pass</span>

    <span class="s0">def </span><span class="s1">onSelfButtonRClick</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">item</span><span class="s2">):</span>
        <span class="s1">parentItem </span><span class="s2">= </span><span class="s1">item</span><span class="s2">.</span><span class="s1">getParent</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">resetCtrls</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">addItemCtrls</span><span class="s2">(</span><span class="s1">parentItem</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">onChildButtonLClick</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">item</span><span class="s2">):</span>
        <span class="s0">if </span><span class="s1">item</span><span class="s2">.</span><span class="s1">getNumChildren</span><span class="s2">() == </span><span class="s4">0</span><span class="s2">:</span>
            <span class="s0">return</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">resetCtrls</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">addItemCtrls</span><span class="s2">(</span><span class="s1">item</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">onChildButtonRClick</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">item</span><span class="s2">):</span>
        <span class="s1">parentItem </span><span class="s2">= </span><span class="s1">item</span><span class="s2">.</span><span class="s1">getParent</span><span class="s2">()</span>

        <span class="s0">if </span><span class="s1">parentItem</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">resetCtrls</span><span class="s2">()</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">addItemCtrls</span><span class="s2">(</span><span class="s1">parentItem</span><span class="s2">.</span><span class="s1">getParent</span><span class="s2">())</span>

    <span class="s0">def </span><span class="s1">addItemCtrls</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">item</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">rootItem </span><span class="s2">= </span><span class="s1">item</span>
        <span class="s0">if </span><span class="s1">item </span><span class="s2">== </span><span class="s0">None</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">createDefaultCtrls</span><span class="s2">()</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">addSelfCtrl</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">item</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">())</span>

            <span class="s0">for </span><span class="s1">child </span><span class="s0">in </span><span class="s1">item</span><span class="s2">.</span><span class="s1">getChildren</span><span class="s2">():</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">addChildCtrl</span><span class="s2">(</span><span class="s1">child</span><span class="s2">, </span><span class="s1">item</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">())</span>

            <span class="s1">self</span><span class="s2">.</span><span class="s1">setTitle</span><span class="s2">(</span><span class="s1">item</span><span class="s2">.</span><span class="s1">getPathName</span><span class="s2">(), </span><span class="s1">item</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">())</span>

    <span class="s3">#--------------------------------------------------------------------------</span>
    <span class="s3"># List &amp; Analyze</span>
    <span class="s3">#--------------------------------------------------------------------------</span>
    <span class="s0">def </span><span class="s1">makeList</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">renderItem </span><span class="s2">= </span><span class="s1">MemoryExplorerItem</span><span class="s2">(</span><span class="s0">None</span><span class="s2">, </span><span class="s1">render</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">buildList</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">renderItem</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">render2dItem </span><span class="s2">= </span><span class="s1">MemoryExplorerItem</span><span class="s2">(</span><span class="s0">None</span><span class="s2">, </span><span class="s1">render2d</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">buildList</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">render2dItem</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">buildList</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">parentItem</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">nodePath </span><span class="s0">in </span><span class="s1">parentItem</span><span class="s2">.</span><span class="s1">nodePath</span><span class="s2">.</span><span class="s1">getChildren</span><span class="s2">():</span>
            <span class="s1">item </span><span class="s2">= </span><span class="s1">MemoryExplorerItem</span><span class="s2">(</span><span class="s1">parentItem</span><span class="s2">, </span><span class="s1">nodePath</span><span class="s2">)</span>
            <span class="s1">parentItem</span><span class="s2">.</span><span class="s1">addChild</span><span class="s2">(</span><span class="s1">item</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">buildList</span><span class="s2">(</span><span class="s1">item</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">analyze</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">renderItem</span><span class="s2">.</span><span class="s1">analyze</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">render2dItem</span><span class="s2">.</span><span class="s1">analyze</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">refresh</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">makeList</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">analyze</span><span class="s2">()</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">resetCtrls</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">createDefaultCtrls</span><span class="s2">()</span>

<span class="s3">#--------------------------------------------------------------------------</span>
<span class="s3">#--------------------------------------------------------------------------</span>
<span class="s0">class </span><span class="s1">MemoryExplorerItem</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">parent</span><span class="s2">, </span><span class="s1">nodePath</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">parent </span><span class="s2">= </span><span class="s1">parent</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">nodePath </span><span class="s2">= </span><span class="s1">nodePath</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">children </span><span class="s2">= []</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">selfVertexBytes </span><span class="s2">= </span><span class="s4">0</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">childrenVertexBytes </span><span class="s2">= </span><span class="s4">0</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">numFaces </span><span class="s2">= </span><span class="s4">0</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">textureBytes </span><span class="s2">= </span><span class="s4">0</span>

        <span class="s0">if </span><span class="s1">parent</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">pathName </span><span class="s2">= </span><span class="s1">parent</span><span class="s2">.</span><span class="s1">pathName </span><span class="s2">+ </span><span class="s5">&quot;/&quot; </span><span class="s2">+  </span><span class="s1">nodePath</span><span class="s2">.</span><span class="s1">getName</span><span class="s2">()</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">pathName </span><span class="s2">= </span><span class="s1">nodePath</span><span class="s2">.</span><span class="s1">getName</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">getParent</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">parent</span>

    <span class="s0">def </span><span class="s1">addChild</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">child</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">children</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">child</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">getNumChildren</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">return </span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">children</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">getChildren</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">children</span>

    <span class="s0">def </span><span class="s1">getName</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">nodePath</span><span class="s2">.</span><span class="s1">getName</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">getPathName</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">pathName</span>

    <span class="s0">def </span><span class="s1">getVertexBytes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">selfVertexBytes </span><span class="s2">+ </span><span class="s1">self</span><span class="s2">.</span><span class="s1">childrenVertexBytes</span>

    <span class="s0">def </span><span class="s1">getSelfVertexBytes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">selfVertexBytes</span>

    <span class="s0">def </span><span class="s1">analyze</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">selfVertexBytes </span><span class="s2">= </span><span class="s4">0</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">childrenVertexBytes </span><span class="s2">= </span><span class="s4">0</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">numFaces </span><span class="s2">= </span><span class="s4">0</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">textureBytes </span><span class="s2">= </span><span class="s4">0</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">calcTextureBytes</span><span class="s2">()</span>

        <span class="s0">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">nodePath</span><span class="s2">.</span><span class="s1">node</span><span class="s2">().</span><span class="s1">isGeomNode</span><span class="s2">():</span>
            <span class="s1">geomNode </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">nodePath</span><span class="s2">.</span><span class="s1">node</span><span class="s2">()</span>

            <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s1">geomNode</span><span class="s2">.</span><span class="s1">getNumGeoms</span><span class="s2">()):</span>
                <span class="s1">geom </span><span class="s2">= </span><span class="s1">geomNode</span><span class="s2">.</span><span class="s1">getGeom</span><span class="s2">(</span><span class="s1">i</span><span class="s2">)</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">calcVertexBytes</span><span class="s2">(</span><span class="s1">geom</span><span class="s2">)</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">calcNumFaces</span><span class="s2">(</span><span class="s1">geom</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">analyzeChildren</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">calcVertexBytes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">geom</span><span class="s2">):</span>
        <span class="s1">vData </span><span class="s2">= </span><span class="s1">geom</span><span class="s2">.</span><span class="s1">getVertexData</span><span class="s2">()</span>
        <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s1">vData</span><span class="s2">.</span><span class="s1">getNumArrays</span><span class="s2">()):</span>
            <span class="s1">array </span><span class="s2">= </span><span class="s1">vData</span><span class="s2">.</span><span class="s1">getArray</span><span class="s2">(</span><span class="s1">j</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">selfVertexBytes </span><span class="s2">+= </span><span class="s1">array</span><span class="s2">.</span><span class="s1">getDataSizeBytes</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">calcTextureBytes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">texCol </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">nodePath</span><span class="s2">.</span><span class="s1">findAllTextures</span><span class="s2">()</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s1">texCol</span><span class="s2">.</span><span class="s1">getNumTextures</span><span class="s2">()):</span>
            <span class="s1">tex </span><span class="s2">= </span><span class="s1">texCol</span><span class="s2">.</span><span class="s1">getTexture</span><span class="s2">(</span><span class="s1">i</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">textureBytes </span><span class="s2">+= </span><span class="s1">tex</span><span class="s2">.</span><span class="s1">estimateTextureMemory</span><span class="s2">()</span>

            <span class="s3"># what about shared textures by multiple nodes ?</span>

    <span class="s0">def </span><span class="s1">calcNumFaces</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">geom</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s1">geom</span><span class="s2">.</span><span class="s1">getNumPrimitives</span><span class="s2">()):</span>
            <span class="s1">primitive </span><span class="s2">= </span><span class="s1">geom</span><span class="s2">.</span><span class="s1">getPrimitive</span><span class="s2">(</span><span class="s1">k</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">numFaces </span><span class="s2">+= </span><span class="s1">primitive</span><span class="s2">.</span><span class="s1">getNumFaces</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">analyzeChildren</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">child </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">children</span><span class="s2">:</span>
            <span class="s1">child</span><span class="s2">.</span><span class="s1">analyze</span><span class="s2">()</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">childrenVertexBytes </span><span class="s2">+= </span><span class="s1">child</span><span class="s2">.</span><span class="s1">getVertexBytes</span><span class="s2">()</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">numFaces </span><span class="s2">+= </span><span class="s1">child</span><span class="s2">.</span><span class="s1">numFaces</span>

    <span class="s0">def </span><span class="s1">ls</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">indent </span><span class="s2">= </span><span class="s5">&quot;&quot;</span><span class="s2">):</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s1">indent </span><span class="s2">+ </span><span class="s1">self</span><span class="s2">.</span><span class="s1">nodePath</span><span class="s2">.</span><span class="s1">getName</span><span class="s2">() + </span><span class="s5">&quot; &quot; </span><span class="s2">+ </span><span class="s1">str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">vertexBytes</span><span class="s2">) + </span><span class="s5">&quot; &quot; </span><span class="s2">+ </span><span class="s1">str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">numFaces</span><span class="s2">) + </span><span class="s5">&quot; &quot; </span><span class="s2">+ </span><span class="s1">str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">textureBytes</span><span class="s2">))</span>
        <span class="s1">indent </span><span class="s2">= </span><span class="s1">indent </span><span class="s2">+  </span><span class="s5">&quot; &quot;</span>

        <span class="s0">for </span><span class="s1">child </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">children</span><span class="s2">:</span>
            <span class="s1">child</span><span class="s2">.</span><span class="s1">ls</span><span class="s2">(</span><span class="s1">indent</span><span class="s2">)</span>
</pre>
</body>
</html>