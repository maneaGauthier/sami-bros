<html>
<head>
<title>DWBPackageInstaller.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #cf8e6d;}
.s5 { color: #2aacb8;}
.s6 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
DWBPackageInstaller.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; 
.. deprecated:: 1.10.0 
   The p3d packaging system has been replaced with the new setuptools-based 
   system.  See the :ref:`distribution` manual section. 
&quot;&quot;&quot;</span>
<span class="s1">__all__ </span><span class="s2">= [</span><span class="s3">&quot;DWBPackageInstaller&quot;</span><span class="s2">]</span>

<span class="s4">from </span><span class="s1">direct</span><span class="s2">.</span><span class="s1">p3d</span><span class="s2">.</span><span class="s1">PackageInstaller </span><span class="s4">import </span><span class="s1">PackageInstaller</span>
<span class="s4">from </span><span class="s1">direct</span><span class="s2">.</span><span class="s1">gui</span><span class="s2">.</span><span class="s1">DirectWaitBar </span><span class="s4">import </span><span class="s1">DirectWaitBar</span>
<span class="s4">from </span><span class="s1">direct</span><span class="s2">.</span><span class="s1">gui </span><span class="s4">import </span><span class="s1">DirectGuiGlobals </span><span class="s4">as </span><span class="s1">DGG</span>

<span class="s4">class </span><span class="s1">DWBPackageInstaller</span><span class="s2">(</span><span class="s1">DirectWaitBar</span><span class="s2">, </span><span class="s1">PackageInstaller</span><span class="s2">):</span>
    <span class="s0">&quot;&quot;&quot; This class presents a PackageInstaller that also inherits from 
    DirectWaitBar, so it updates its own GUI as it downloads. 
 
    Specify perPackage = True to make the progress bar reset for each 
    package, or False (the default) to show one continuous progress 
    bar for all packages. 
 
    Specify updateText = True (the default) to update the text label 
    with the name of the package or False to leave it up to you to set 
    it. 
 
    You can specify a callback function with finished = func; this 
    function will be called, with one boolean parameter, when the 
    download has completed.  The parameter will be true on success, or 
    false on failure. 
    &quot;&quot;&quot;</span>

    <span class="s4">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">appRunner</span><span class="s2">, </span><span class="s1">parent </span><span class="s2">= </span><span class="s4">None</span><span class="s2">, **</span><span class="s1">kw</span><span class="s2">):</span>
        <span class="s1">PackageInstaller</span><span class="s2">.</span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">appRunner</span><span class="s2">)</span>

        <span class="s1">optiondefs </span><span class="s2">= (</span>
            <span class="s2">(</span><span class="s3">'borderWidth'</span><span class="s2">,    (</span><span class="s5">0.01</span><span class="s2">, </span><span class="s5">0.01</span><span class="s2">),       </span><span class="s4">None</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'relief'</span><span class="s2">,         </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">SUNKEN</span><span class="s2">,         </span><span class="s1">self</span><span class="s2">.</span><span class="s1">setRelief</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'range'</span><span class="s2">,          </span><span class="s5">1</span><span class="s2">,                  </span><span class="s1">self</span><span class="s2">.</span><span class="s1">setRange</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'barBorderWidth'</span><span class="s2">, (</span><span class="s5">0.01</span><span class="s2">, </span><span class="s5">0.01</span><span class="s2">),       </span><span class="s1">self</span><span class="s2">.</span><span class="s1">setBarBorderWidth</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'barColor'</span><span class="s2">,       (</span><span class="s5">0.424</span><span class="s2">, </span><span class="s5">0.647</span><span class="s2">, </span><span class="s5">0.878</span><span class="s2">, </span><span class="s5">1</span><span class="s2">),  </span><span class="s1">self</span><span class="s2">.</span><span class="s1">setBarColor</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'barRelief'</span><span class="s2">,      </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">RAISED</span><span class="s2">,         </span><span class="s1">self</span><span class="s2">.</span><span class="s1">setBarRelief</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'text'</span><span class="s2">,           </span><span class="s3">'Starting'</span><span class="s2">,         </span><span class="s1">self</span><span class="s2">.</span><span class="s1">setText</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'text_pos'</span><span class="s2">,       (</span><span class="s5">0</span><span class="s2">, -</span><span class="s5">0.025</span><span class="s2">),        </span><span class="s4">None</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'text_scale'</span><span class="s2">,     </span><span class="s5">0.1</span><span class="s2">,                </span><span class="s4">None</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'perPackage'</span><span class="s2">,     </span><span class="s4">False</span><span class="s2">,              </span><span class="s4">None</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'updateText'</span><span class="s2">,     </span><span class="s4">True</span><span class="s2">,               </span><span class="s4">None</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'finished'</span><span class="s2">,       </span><span class="s4">None</span><span class="s2">,               </span><span class="s4">None</span><span class="s2">),</span>
            <span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">defineoptions</span><span class="s2">(</span><span class="s1">kw</span><span class="s2">, </span><span class="s1">optiondefs</span><span class="s2">)</span>
        <span class="s1">DirectWaitBar</span><span class="s2">.</span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">parent</span><span class="s2">, **</span><span class="s1">kw</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">initialiseoptions</span><span class="s2">(</span><span class="s1">DWBPackageInstaller</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">updateBarStyle</span><span class="s2">()</span>

        <span class="s6"># Hidden by default until the download begins.</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">hide</span><span class="s2">()</span>

    <span class="s4">def </span><span class="s1">cleanup</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">PackageInstaller</span><span class="s2">.</span><span class="s1">cleanup</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">DirectWaitBar</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">destroy</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">PackageInstaller</span><span class="s2">.</span><span class="s1">cleanup</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">DirectWaitBar</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">packageStarted</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">package</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot; This callback is made for each package between 
        downloadStarted() and downloadFinished() to indicate the start 
        of a new package. &quot;&quot;&quot;</span>
        <span class="s4">if </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'updateText'</span><span class="s2">]:</span>
            <span class="s1">self</span><span class="s2">[</span><span class="s3">'text'</span><span class="s2">] = </span><span class="s3">'Installing %s' </span><span class="s2">% (</span><span class="s1">package</span><span class="s2">.</span><span class="s1">getFormattedName</span><span class="s2">())</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">show</span><span class="s2">()</span>

    <span class="s4">def </span><span class="s1">packageProgress</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">package</span><span class="s2">, </span><span class="s1">progress</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot; This callback is made repeatedly between packageStarted() 
        and packageFinished() to update the current progress on the 
        indicated package only.  The progress value ranges from 0 
        (beginning) to 1 (complete). &quot;&quot;&quot;</span>

        <span class="s4">if </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'perPackage'</span><span class="s2">]:</span>
            <span class="s1">self</span><span class="s2">[</span><span class="s3">'value'</span><span class="s2">] = </span><span class="s1">progress </span><span class="s2">* </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'range'</span><span class="s2">]</span>

    <span class="s4">def </span><span class="s1">downloadProgress</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">overallProgress</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot; This callback is made repeatedly between downloadStarted() 
        and downloadFinished() to update the current progress through 
        all packages.  The progress value ranges from 0 (beginning) to 
        1 (complete). &quot;&quot;&quot;</span>

        <span class="s4">if not </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'perPackage'</span><span class="s2">]:</span>
            <span class="s1">self</span><span class="s2">[</span><span class="s3">'value'</span><span class="s2">] = </span><span class="s1">overallProgress </span><span class="s2">* </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'range'</span><span class="s2">]</span>

    <span class="s4">def </span><span class="s1">downloadFinished</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">success</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot; This callback is made when all of the packages have been 
        downloaded and installed (or there has been some failure).  If 
        all packages where successfully installed, success is True. 
 
        If there were no packages that required downloading, this 
        callback will be made immediately, *without* a corresponding 
        call to downloadStarted(). &quot;&quot;&quot;</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">hide</span><span class="s2">()</span>

        <span class="s4">if </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'finished'</span><span class="s2">]:</span>
            <span class="s1">self</span><span class="s2">[</span><span class="s3">'finished'</span><span class="s2">](</span><span class="s1">success</span><span class="s2">)</span>
</pre>
</body>
</html>