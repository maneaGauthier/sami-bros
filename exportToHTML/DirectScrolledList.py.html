<html>
<head>
<title>DirectScrolledList.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #cf8e6d;}
.s5 { color: #2aacb8;}
.s6 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
DirectScrolledList.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot;Contains the DirectScrolledList class. 
 
See the :ref:`directscrolledlist` page in the programming manual for a more 
in-depth explanation and an example of how to use this class. 
&quot;&quot;&quot;</span>

<span class="s1">__all__ </span><span class="s2">= [</span><span class="s3">'DirectScrolledListItem'</span><span class="s2">, </span><span class="s3">'DirectScrolledList'</span><span class="s2">]</span>

<span class="s4">from </span><span class="s1">panda3d</span><span class="s2">.</span><span class="s1">core </span><span class="s4">import </span><span class="s2">*</span>
<span class="s4">from </span><span class="s1">direct</span><span class="s2">.</span><span class="s1">showbase </span><span class="s4">import </span><span class="s1">ShowBaseGlobal</span>
<span class="s4">from </span><span class="s2">. </span><span class="s4">import </span><span class="s1">DirectGuiGlobals </span><span class="s4">as </span><span class="s1">DGG</span>
<span class="s4">from </span><span class="s1">direct</span><span class="s2">.</span><span class="s1">directnotify </span><span class="s4">import </span><span class="s1">DirectNotifyGlobal</span>
<span class="s4">from </span><span class="s1">direct</span><span class="s2">.</span><span class="s1">task</span><span class="s2">.</span><span class="s1">Task </span><span class="s4">import </span><span class="s1">Task</span>
<span class="s4">from </span><span class="s2">.</span><span class="s1">DirectFrame </span><span class="s4">import </span><span class="s2">*</span>
<span class="s4">from </span><span class="s2">.</span><span class="s1">DirectButton </span><span class="s4">import </span><span class="s2">*</span>
<span class="s4">import </span><span class="s1">sys</span>

<span class="s4">if </span><span class="s1">sys</span><span class="s2">.</span><span class="s1">version_info </span><span class="s2">&gt;= (</span><span class="s5">3</span><span class="s2">,</span><span class="s5">0</span><span class="s2">):</span>
    <span class="s1">stringType </span><span class="s2">= </span><span class="s1">str</span>
<span class="s4">else</span><span class="s2">:</span>
    <span class="s1">stringType </span><span class="s2">= </span><span class="s1">basestring</span>


<span class="s4">class </span><span class="s1">DirectScrolledListItem</span><span class="s2">(</span><span class="s1">DirectButton</span><span class="s2">):</span>
    <span class="s0">&quot;&quot;&quot; 
    While you are not required to use a DirectScrolledListItem for a 
    DirectScrolledList, doing so takes care of the highlighting and 
    unhighlighting of the list items. 
    &quot;&quot;&quot;</span>
    <span class="s1">notify </span><span class="s2">= </span><span class="s1">DirectNotifyGlobal</span><span class="s2">.</span><span class="s1">directNotify</span><span class="s2">.</span><span class="s1">newCategory</span><span class="s2">(</span><span class="s3">&quot;DirectScrolledListItem&quot;</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">parent</span><span class="s2">=</span><span class="s4">None</span><span class="s2">, **</span><span class="s1">kw</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_parent </span><span class="s2">= </span><span class="s1">parent</span>
        <span class="s4">if </span><span class="s3">&quot;command&quot; </span><span class="s4">in </span><span class="s1">kw</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">nextCommand </span><span class="s2">= </span><span class="s1">kw</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s3">&quot;command&quot;</span><span class="s2">)</span>
            <span class="s4">del </span><span class="s1">kw</span><span class="s2">[</span><span class="s3">&quot;command&quot;</span><span class="s2">]</span>
        <span class="s4">if </span><span class="s3">&quot;extraArgs&quot; </span><span class="s4">in </span><span class="s1">kw</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">nextCommandExtraArgs </span><span class="s2">= </span><span class="s1">kw</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s3">&quot;extraArgs&quot;</span><span class="s2">)</span>
            <span class="s4">del </span><span class="s1">kw</span><span class="s2">[</span><span class="s3">&quot;extraArgs&quot;</span><span class="s2">]</span>
        <span class="s1">optiondefs </span><span class="s2">= (</span>
            <span class="s2">(</span><span class="s3">'parent'</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_parent</span><span class="s2">,    </span><span class="s4">None</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'command'</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">select</span><span class="s2">, </span><span class="s4">None</span><span class="s2">),</span>
            <span class="s2">)</span>
        <span class="s6"># Merge keyword options with default options</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">defineoptions</span><span class="s2">(</span><span class="s1">kw</span><span class="s2">, </span><span class="s1">optiondefs</span><span class="s2">)</span>
        <span class="s1">DirectButton</span><span class="s2">.</span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">initialiseoptions</span><span class="s2">(</span><span class="s1">DirectScrolledListItem</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">select</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">nextCommand</span><span class="s2">(*</span><span class="s1">self</span><span class="s2">.</span><span class="s1">nextCommandExtraArgs</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_parent</span><span class="s2">.</span><span class="s1">selectListItem</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>


<span class="s4">class </span><span class="s1">DirectScrolledList</span><span class="s2">(</span><span class="s1">DirectFrame</span><span class="s2">):</span>
    <span class="s1">notify </span><span class="s2">= </span><span class="s1">DirectNotifyGlobal</span><span class="s2">.</span><span class="s1">directNotify</span><span class="s2">.</span><span class="s1">newCategory</span><span class="s2">(</span><span class="s3">&quot;DirectScrolledList&quot;</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">parent </span><span class="s2">= </span><span class="s4">None</span><span class="s2">, **</span><span class="s1">kw</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s5">0</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">__forceHeight </span><span class="s2">= </span><span class="s4">None</span>

        <span class="s3">&quot;&quot;&quot; If one were to want a scrolledList that makes and adds its items 
           as needed, simply pass in an items list of strings (type 'str') 
           and when that item is needed, itemMakeFunction will be called 
           with the text, the index, and itemMakeExtraArgs.  If itemMakeFunction 
           is not specified, it will create a DirectFrame with the text.&quot;&quot;&quot;</span>

        <span class="s6"># if 'items' is a list of strings, make a copy for our use</span>
        <span class="s6"># so we can modify it without mangling the user's list</span>
        <span class="s4">if </span><span class="s3">'items' </span><span class="s4">in </span><span class="s1">kw</span><span class="s2">:</span>
            <span class="s4">for </span><span class="s1">item </span><span class="s4">in </span><span class="s1">kw</span><span class="s2">[</span><span class="s3">'items'</span><span class="s2">]:</span>
                <span class="s4">if not </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">stringType</span><span class="s2">):</span>
                    <span class="s4">break</span>
            <span class="s4">else</span><span class="s2">:</span>
                <span class="s6"># we get here if every item in 'items' is a string</span>
                <span class="s6"># make a copy</span>
                <span class="s1">kw</span><span class="s2">[</span><span class="s3">'items'</span><span class="s2">] = </span><span class="s1">kw</span><span class="s2">[</span><span class="s3">'items'</span><span class="s2">][:]</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">nextItemID </span><span class="s2">= </span><span class="s5">10</span>

        <span class="s6"># Inherits from DirectFrame</span>
        <span class="s1">optiondefs </span><span class="s2">= (</span>
            <span class="s6"># Define type of DirectGuiWidget</span>
            <span class="s2">(</span><span class="s3">'items'</span><span class="s2">,              [],        </span><span class="s4">None</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'itemsAlign'</span><span class="s2">,  </span><span class="s1">TextNode</span><span class="s2">.</span><span class="s1">ACenter</span><span class="s2">, </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">INITOPT</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'itemsWordwrap'</span><span class="s2">,      </span><span class="s4">None</span><span class="s2">,      </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">INITOPT</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'command'</span><span class="s2">,            </span><span class="s4">None</span><span class="s2">,      </span><span class="s4">None</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'extraArgs'</span><span class="s2">,          [],        </span><span class="s4">None</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'itemMakeFunction'</span><span class="s2">,   </span><span class="s4">None</span><span class="s2">,      </span><span class="s4">None</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'itemMakeExtraArgs'</span><span class="s2">,  [],        </span><span class="s4">None</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'numItemsVisible'</span><span class="s2">,    </span><span class="s5">1</span><span class="s2">,         </span><span class="s1">self</span><span class="s2">.</span><span class="s1">setNumItemsVisible</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'scrollSpeed'</span><span class="s2">,        </span><span class="s5">8</span><span class="s2">,         </span><span class="s1">self</span><span class="s2">.</span><span class="s1">setScrollSpeed</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'forceHeight'</span><span class="s2">,        </span><span class="s4">None</span><span class="s2">,      </span><span class="s1">self</span><span class="s2">.</span><span class="s1">setForceHeight</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'incButtonCallback'</span><span class="s2">,  </span><span class="s4">None</span><span class="s2">,      </span><span class="s1">self</span><span class="s2">.</span><span class="s1">setIncButtonCallback</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">'decButtonCallback'</span><span class="s2">,  </span><span class="s4">None</span><span class="s2">,      </span><span class="s1">self</span><span class="s2">.</span><span class="s1">setDecButtonCallback</span><span class="s2">),</span>
            <span class="s2">)</span>
        <span class="s6"># Merge keyword options with default options</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">defineoptions</span><span class="s2">(</span><span class="s1">kw</span><span class="s2">, </span><span class="s1">optiondefs</span><span class="s2">)</span>

        <span class="s6"># Initialize superclasses</span>
        <span class="s1">DirectFrame</span><span class="s2">.</span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">parent</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">incButton </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">createcomponent</span><span class="s2">(</span><span class="s3">&quot;incButton&quot;</span><span class="s2">, (), </span><span class="s4">None</span><span class="s2">,</span>
                                              <span class="s1">DirectButton</span><span class="s2">, (</span><span class="s1">self</span><span class="s2">,),</span>
                                              <span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">incButton</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">B1PRESS</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__incButtonDown</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">incButton</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">B1RELEASE</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__buttonUp</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">decButton </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">createcomponent</span><span class="s2">(</span><span class="s3">&quot;decButton&quot;</span><span class="s2">, (), </span><span class="s4">None</span><span class="s2">,</span>
                                              <span class="s1">DirectButton</span><span class="s2">, (</span><span class="s1">self</span><span class="s2">,),</span>
                                              <span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">decButton</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">B1PRESS</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__decButtonDown</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">decButton</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">B1RELEASE</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__buttonUp</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">itemFrame </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">createcomponent</span><span class="s2">(</span><span class="s3">&quot;itemFrame&quot;</span><span class="s2">, (), </span><span class="s4">None</span><span class="s2">,</span>
                                              <span class="s1">DirectFrame</span><span class="s2">, (</span><span class="s1">self</span><span class="s2">,),</span>
                                              <span class="s2">)</span>
        <span class="s4">for </span><span class="s1">item </span><span class="s4">in </span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">]:</span>
            <span class="s4">if not </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">stringType</span><span class="s2">):</span>
                <span class="s1">item</span><span class="s2">.</span><span class="s1">reparentTo</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">itemFrame</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">initialiseoptions</span><span class="s2">(</span><span class="s1">DirectScrolledList</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">recordMaxHeight</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">scrollTo</span><span class="s2">(</span><span class="s5">0</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">setForceHeight</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">__forceHeight </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;forceHeight&quot;</span><span class="s2">]</span>

    <span class="s4">def </span><span class="s1">recordMaxHeight</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__forceHeight </span><span class="s4">is not None</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">maxHeight </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__forceHeight</span>
        <span class="s4">else</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">maxHeight </span><span class="s2">= </span><span class="s5">0.0</span>
            <span class="s4">for </span><span class="s1">item </span><span class="s4">in </span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">]:</span>
                <span class="s4">if not </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">stringType</span><span class="s2">):</span>
                    <span class="s1">self</span><span class="s2">.</span><span class="s1">maxHeight </span><span class="s2">= </span><span class="s1">max</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">maxHeight</span><span class="s2">, </span><span class="s1">item</span><span class="s2">.</span><span class="s1">getHeight</span><span class="s2">())</span>

    <span class="s4">def </span><span class="s1">setScrollSpeed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s6"># Items per second to move</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">__scrollSpeed </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;scrollSpeed&quot;</span><span class="s2">]</span>
        <span class="s4">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__scrollSpeed </span><span class="s2">&lt;= </span><span class="s5">0</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">__scrollSpeed </span><span class="s2">= </span><span class="s5">1</span>

    <span class="s4">def </span><span class="s1">setNumItemsVisible</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s6"># Items per second to move</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">__numItemsVisible </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;numItemsVisible&quot;</span><span class="s2">]</span>

    <span class="s4">def </span><span class="s1">destroy</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">taskMgr</span><span class="s2">.</span><span class="s1">remove</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">taskName</span><span class="s2">(</span><span class="s3">&quot;scroll&quot;</span><span class="s2">))</span>
        <span class="s4">if </span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s3">&quot;currentSelected&quot;</span><span class="s2">):</span>
            <span class="s4">del </span><span class="s1">self</span><span class="s2">.</span><span class="s1">currentSelected</span>
        <span class="s4">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__incButtonCallback</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">__incButtonCallback </span><span class="s2">= </span><span class="s4">None</span>
        <span class="s4">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__decButtonCallback</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">__decButtonCallback </span><span class="s2">= </span><span class="s4">None</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">incButton</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">decButton</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">()</span>
        <span class="s1">DirectFrame</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">selectListItem</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">item</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s3">&quot;currentSelected&quot;</span><span class="s2">):</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">currentSelected</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">]=</span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">NORMAL</span>
        <span class="s1">item</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">]=</span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">DISABLED</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">currentSelected</span><span class="s2">=</span><span class="s1">item</span>

    <span class="s4">def </span><span class="s1">scrollBy</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">delta</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s6">#print &quot;scrollBy[&quot;, delta,&quot;]&quot;</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">scrollTo</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">index </span><span class="s2">+ </span><span class="s1">delta</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">getItemIndexForItemID</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">itemID</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s6">#for i in range(len(self[&quot;items&quot;])):</span>
        <span class="s6">#    print &quot;buttontext[&quot;, i,&quot;]&quot;, self[&quot;items&quot;][i][&quot;text&quot;]</span>

        <span class="s4">if </span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">]) == </span><span class="s5">0</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s5">0</span>

        <span class="s4">if </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">][</span><span class="s5">0</span><span class="s2">], </span><span class="s1">stringType</span><span class="s2">):</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">warning</span><span class="s2">(</span><span class="s3">&quot;getItemIndexForItemID: cant find itemID for non-class list items!&quot;</span><span class="s2">)</span>
            <span class="s4">return </span><span class="s5">0</span>

        <span class="s4">for </span><span class="s1">i </span><span class="s4">in </span><span class="s1">range</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">])):</span>
            <span class="s4">if</span><span class="s2">(</span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">][</span><span class="s1">i</span><span class="s2">].</span><span class="s1">itemID </span><span class="s2">== </span><span class="s1">itemID</span><span class="s2">):</span>
                <span class="s4">return </span><span class="s1">i</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">warning</span><span class="s2">(</span><span class="s3">&quot;getItemIndexForItemID: item not found!&quot;</span><span class="s2">)</span>
        <span class="s4">return </span><span class="s5">0</span>

    <span class="s4">def </span><span class="s1">scrollToItemID</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">itemID</span><span class="s2">, </span><span class="s1">centered</span><span class="s2">=</span><span class="s5">0</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">scrollTo</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">getItemIndexForItemID</span><span class="s2">(</span><span class="s1">itemID</span><span class="s2">), </span><span class="s1">centered</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">scrollTo</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">centered</span><span class="s2">=</span><span class="s5">0</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot; scrolls list so selected index is at top, or centered in box&quot;&quot;&quot;</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s6">#print &quot;scrollTo[&quot;, index,&quot;] called, len(self[items])=&quot;, len(self[&quot;items&quot;]),&quot; self[numItemsVisible]=&quot;, self[&quot;numItemsVisible&quot;]</span>
        <span class="s4">try</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;numItemsVisible&quot;</span><span class="s2">]</span>
        <span class="s4">except</span><span class="s2">:</span>
            <span class="s6"># RAU hack to kill 27633</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">info</span><span class="s2">(</span><span class="s3">'crash 27633 fixed!'</span><span class="s2">)</span>
            <span class="s4">return</span>

        <span class="s1">numItemsVisible </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;numItemsVisible&quot;</span><span class="s2">]</span>
        <span class="s1">numItemsTotal </span><span class="s2">= </span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">])</span>
        <span class="s4">if</span><span class="s2">(</span><span class="s1">centered</span><span class="s2">):</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">index </span><span class="s2">- (</span><span class="s1">numItemsVisible </span><span class="s2">// </span><span class="s5">2</span><span class="s2">)</span>
        <span class="s4">else</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">index</span>

        <span class="s6"># Not enough items to even worry about scrolling,</span>
        <span class="s6"># just disable the buttons and do nothing</span>
        <span class="s4">if </span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">]) &lt;= </span><span class="s1">numItemsVisible</span><span class="s2">):</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">incButton</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">] = </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">DISABLED</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">decButton</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">] = </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">DISABLED</span>
            <span class="s6"># Hmm.. just reset self.index to 0 and bail out</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s5">0</span>
            <span class="s1">ret </span><span class="s2">= </span><span class="s5">0</span>
        <span class="s4">else</span><span class="s2">:</span>
            <span class="s4">if </span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">index </span><span class="s2">&lt;= </span><span class="s5">0</span><span class="s2">):</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s5">0</span>
                <span class="s6">#print &quot;at list start, &quot;, len(self[&quot;items&quot;]),&quot;  &quot;, self[&quot;numItemsVisible&quot;]</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">decButton</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">] = </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">DISABLED</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">incButton</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">] = </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">NORMAL</span>
                <span class="s1">ret </span><span class="s2">= </span><span class="s5">0</span>
            <span class="s4">elif </span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">index </span><span class="s2">&gt;= (</span><span class="s1">numItemsTotal </span><span class="s2">- </span><span class="s1">numItemsVisible</span><span class="s2">)):</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">numItemsTotal </span><span class="s2">- </span><span class="s1">numItemsVisible</span>
                <span class="s6">#print &quot;at list end, &quot;, len(self[&quot;items&quot;]),&quot;  &quot;, self[&quot;numItemsVisible&quot;]</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">incButton</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">] = </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">DISABLED</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">decButton</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">] = </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">NORMAL</span>
                <span class="s1">ret </span><span class="s2">= </span><span class="s5">0</span>
            <span class="s4">else</span><span class="s2">:</span>
                <span class="s6"># deal with an edge condition - make sure any tasks are removed from the disabled arrows.</span>
                <span class="s4">if </span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">incButton</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">] == </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">DISABLED</span><span class="s2">) </span><span class="s4">or </span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">decButton</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">] == </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">DISABLED</span><span class="s2">):</span>
                    <span class="s6">#print &quot;leaving list start/end, &quot;, len(self[&quot;items&quot;]),&quot;  &quot;, self[&quot;numItemsVisible&quot;]</span>
                    <span class="s1">self</span><span class="s2">.</span><span class="s1">__buttonUp</span><span class="s2">(</span><span class="s5">0</span><span class="s2">)</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">incButton</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">] = </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">NORMAL</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">decButton</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">] = </span><span class="s1">DGG</span><span class="s2">.</span><span class="s1">NORMAL</span>
                <span class="s1">ret </span><span class="s2">= </span><span class="s5">1</span>

        <span class="s6">#print &quot;self.index set to &quot;, self.index</span>

        <span class="s6"># Hide them all</span>
        <span class="s4">for </span><span class="s1">item </span><span class="s4">in </span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">]:</span>
            <span class="s4">if not </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">stringType</span><span class="s2">):</span>
                <span class="s1">item</span><span class="s2">.</span><span class="s1">hide</span><span class="s2">()</span>

        <span class="s6"># Then show the ones in range, and stack their positions</span>
        <span class="s1">upperRange </span><span class="s2">= </span><span class="s1">min</span><span class="s2">(</span><span class="s1">numItemsTotal</span><span class="s2">, </span><span class="s1">numItemsVisible</span><span class="s2">)</span>
        <span class="s4">for </span><span class="s1">i </span><span class="s4">in </span><span class="s1">range</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">index</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">index </span><span class="s2">+ </span><span class="s1">upperRange</span><span class="s2">):</span>
            <span class="s1">item </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">][</span><span class="s1">i</span><span class="s2">]</span>
            <span class="s6">#print &quot;stacking buttontext[&quot;, i,&quot;]&quot;, self[&quot;items&quot;][i][&quot;text&quot;]</span>
            <span class="s6"># If the item is a 'str', then it has not been created (scrolled list is 'as needed')</span>
            <span class="s6">#  Therefore, use the the function given to make it or just make it a frame</span>
            <span class="s4">if </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">stringType</span><span class="s2">):</span>
                <span class="s4">if </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'itemMakeFunction'</span><span class="s2">]:</span>
                    <span class="s6"># If there is a function to create the item</span>
                    <span class="s1">item </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'itemMakeFunction'</span><span class="s2">](</span><span class="s1">item</span><span class="s2">, </span><span class="s1">i</span><span class="s2">, </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'itemMakeExtraArgs'</span><span class="s2">])</span>
                <span class="s4">else</span><span class="s2">:</span>
                    <span class="s1">item </span><span class="s2">= </span><span class="s1">DirectFrame</span><span class="s2">(</span><span class="s1">text </span><span class="s2">= </span><span class="s1">item</span><span class="s2">,</span>
                                       <span class="s1">text_align </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'itemsAlign'</span><span class="s2">],</span>
                                       <span class="s1">text_wordwrap </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'itemsWordwrap'</span><span class="s2">],</span>
                                       <span class="s1">relief </span><span class="s2">= </span><span class="s4">None</span><span class="s2">)</span>
                <span class="s6">#print &quot;str stacking buttontext[&quot;, i,&quot;]&quot;, self[&quot;items&quot;][i][&quot;text&quot;]</span>
                <span class="s6"># Then add the newly formed item back into the normal item list</span>
                <span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">][</span><span class="s1">i</span><span class="s2">] = </span><span class="s1">item</span>
                <span class="s1">item</span><span class="s2">.</span><span class="s1">reparentTo</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">itemFrame</span><span class="s2">)</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">recordMaxHeight</span><span class="s2">()</span>

            <span class="s1">item</span><span class="s2">.</span><span class="s1">show</span><span class="s2">()</span>
            <span class="s1">item</span><span class="s2">.</span><span class="s1">setPos</span><span class="s2">(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">,  -(</span><span class="s1">i</span><span class="s2">-</span><span class="s1">self</span><span class="s2">.</span><span class="s1">index</span><span class="s2">) * </span><span class="s1">self</span><span class="s2">.</span><span class="s1">maxHeight</span><span class="s2">)</span>
            <span class="s6">#print 'height bug tracker: i-%s idx-%s h-%s' % (i, self.index, self.maxHeight)</span>

        <span class="s4">if </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'command'</span><span class="s2">]:</span>
            <span class="s6"># Pass any extra args to command</span>
            <span class="s1">self</span><span class="s2">[</span><span class="s3">'command'</span><span class="s2">](*</span><span class="s1">self</span><span class="s2">[</span><span class="s3">'extraArgs'</span><span class="s2">])</span>
        <span class="s4">return </span><span class="s1">ret</span>

    <span class="s4">def </span><span class="s1">makeAllItems</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s4">for </span><span class="s1">i </span><span class="s4">in </span><span class="s1">range</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">[</span><span class="s3">'items'</span><span class="s2">])):</span>
            <span class="s1">item </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">][</span><span class="s1">i</span><span class="s2">]</span>
            <span class="s6"># If the item is a 'str', then it has not been created</span>
            <span class="s6"># Therefore, use the the function given to make it or</span>
            <span class="s6"># just make it a frame</span>
            <span class="s6">#print &quot;Making &quot; + str(item)</span>
            <span class="s4">if </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">stringType</span><span class="s2">):</span>
                <span class="s4">if </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'itemMakeFunction'</span><span class="s2">]:</span>
                    <span class="s6"># If there is a function to create the item</span>
                    <span class="s1">item </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'itemMakeFunction'</span><span class="s2">](</span><span class="s1">item</span><span class="s2">, </span><span class="s1">i</span><span class="s2">, </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'itemMakeExtraArgs'</span><span class="s2">])</span>
                <span class="s4">else</span><span class="s2">:</span>
                    <span class="s1">item </span><span class="s2">= </span><span class="s1">DirectFrame</span><span class="s2">(</span><span class="s1">text </span><span class="s2">= </span><span class="s1">item</span><span class="s2">,</span>
                                       <span class="s1">text_align </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'itemsAlign'</span><span class="s2">],</span>
                                       <span class="s1">text_wordwrap </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'itemsWordwrap'</span><span class="s2">],</span>
                                       <span class="s1">relief </span><span class="s2">= </span><span class="s4">None</span><span class="s2">)</span>
                <span class="s6"># Then add the newly formed item back into the normal item list</span>
                <span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">][</span><span class="s1">i</span><span class="s2">] = </span><span class="s1">item</span>
                <span class="s1">item</span><span class="s2">.</span><span class="s1">reparentTo</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">itemFrame</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">recordMaxHeight</span><span class="s2">()</span>

    <span class="s4">def </span><span class="s1">__scrollByTask</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">task</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s2">((</span><span class="s1">task</span><span class="s2">.</span><span class="s1">time </span><span class="s2">- </span><span class="s1">task</span><span class="s2">.</span><span class="s1">prevTime</span><span class="s2">) &lt; </span><span class="s1">task</span><span class="s2">.</span><span class="s1">delayTime</span><span class="s2">):</span>
            <span class="s4">return </span><span class="s1">Task</span><span class="s2">.</span><span class="s1">cont</span>
        <span class="s4">else</span><span class="s2">:</span>
            <span class="s1">ret </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">scrollBy</span><span class="s2">(</span><span class="s1">task</span><span class="s2">.</span><span class="s1">delta</span><span class="s2">)</span>
            <span class="s1">task</span><span class="s2">.</span><span class="s1">prevTime </span><span class="s2">= </span><span class="s1">task</span><span class="s2">.</span><span class="s1">time</span>
            <span class="s4">if </span><span class="s1">ret</span><span class="s2">:</span>
                <span class="s4">return </span><span class="s1">Task</span><span class="s2">.</span><span class="s1">cont</span>
            <span class="s4">else</span><span class="s2">:</span>
                <span class="s4">return </span><span class="s1">Task</span><span class="s2">.</span><span class="s1">done</span>

    <span class="s4">def </span><span class="s1">__incButtonDown</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">event</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">task </span><span class="s2">= </span><span class="s1">Task</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">__scrollByTask</span><span class="s2">)</span>
        <span class="s1">task</span><span class="s2">.</span><span class="s1">setDelay</span><span class="s2">(</span><span class="s5">1.0 </span><span class="s2">/ </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__scrollSpeed</span><span class="s2">)</span>
        <span class="s1">task</span><span class="s2">.</span><span class="s1">prevTime </span><span class="s2">= </span><span class="s5">0.0</span>
        <span class="s1">task</span><span class="s2">.</span><span class="s1">delta </span><span class="s2">= </span><span class="s5">1</span>
        <span class="s1">taskName </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">taskName</span><span class="s2">(</span><span class="s3">&quot;scroll&quot;</span><span class="s2">)</span>
        <span class="s6">#print &quot;incButtonDown: adding &quot;, taskName</span>
        <span class="s1">taskMgr</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s1">task</span><span class="s2">, </span><span class="s1">taskName</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">scrollBy</span><span class="s2">(</span><span class="s1">task</span><span class="s2">.</span><span class="s1">delta</span><span class="s2">)</span>
        <span class="s1">messenger</span><span class="s2">.</span><span class="s1">send</span><span class="s2">(</span><span class="s3">'wakeup'</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__incButtonCallback</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">__incButtonCallback</span><span class="s2">()</span>

    <span class="s4">def </span><span class="s1">__decButtonDown</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">event</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">task </span><span class="s2">= </span><span class="s1">Task</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">__scrollByTask</span><span class="s2">)</span>
        <span class="s1">task</span><span class="s2">.</span><span class="s1">setDelay</span><span class="s2">(</span><span class="s5">1.0 </span><span class="s2">/ </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__scrollSpeed</span><span class="s2">)</span>
        <span class="s1">task</span><span class="s2">.</span><span class="s1">prevTime </span><span class="s2">= </span><span class="s5">0.0</span>
        <span class="s1">task</span><span class="s2">.</span><span class="s1">delta </span><span class="s2">= -</span><span class="s5">1</span>
        <span class="s1">taskName </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">taskName</span><span class="s2">(</span><span class="s3">&quot;scroll&quot;</span><span class="s2">)</span>
        <span class="s6">#print &quot;decButtonDown: adding &quot;, taskName</span>
        <span class="s1">taskMgr</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s1">task</span><span class="s2">, </span><span class="s1">taskName</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">scrollBy</span><span class="s2">(</span><span class="s1">task</span><span class="s2">.</span><span class="s1">delta</span><span class="s2">)</span>
        <span class="s1">messenger</span><span class="s2">.</span><span class="s1">send</span><span class="s2">(</span><span class="s3">'wakeup'</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__decButtonCallback</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">__decButtonCallback</span><span class="s2">()</span>

    <span class="s4">def </span><span class="s1">__buttonUp</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">event</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">taskName </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">taskName</span><span class="s2">(</span><span class="s3">&quot;scroll&quot;</span><span class="s2">)</span>
        <span class="s6">#print &quot;buttonUp: removing &quot;, taskName</span>
        <span class="s1">taskMgr</span><span class="s2">.</span><span class="s1">remove</span><span class="s2">(</span><span class="s1">taskName</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">addItem</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">item</span><span class="s2">, </span><span class="s1">refresh</span><span class="s2">=</span><span class="s5">1</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot; 
        Add this string and extraArg to the list 
        &quot;&quot;&quot;</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s4">if not </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">stringType</span><span class="s2">):</span>
            <span class="s6"># cant add attribs to non-classes (like strings &amp; ints)</span>
            <span class="s1">item</span><span class="s2">.</span><span class="s1">itemID </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">nextItemID</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">nextItemID </span><span class="s2">+= </span><span class="s5">1</span>
        <span class="s1">self</span><span class="s2">[</span><span class="s3">'items'</span><span class="s2">].</span><span class="s1">append</span><span class="s2">(</span><span class="s1">item</span><span class="s2">)</span>
        <span class="s4">if not </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">stringType</span><span class="s2">):</span>
            <span class="s1">item</span><span class="s2">.</span><span class="s1">reparentTo</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">itemFrame</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">refresh</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">refresh</span><span class="s2">()</span>
        <span class="s4">if not </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">stringType</span><span class="s2">):</span>
            <span class="s4">return </span><span class="s1">item</span><span class="s2">.</span><span class="s1">itemID  </span><span class="s6"># to pass to scrollToItemID</span>

    <span class="s4">def </span><span class="s1">removeItem</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">item</span><span class="s2">, </span><span class="s1">refresh</span><span class="s2">=</span><span class="s5">1</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot; 
        Remove this item from the panel 
        &quot;&quot;&quot;</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s6">#print &quot;remove item called&quot;, item</span>
        <span class="s6">#print &quot;items list&quot;, self['items']</span>
        <span class="s4">if </span><span class="s1">item </span><span class="s4">in </span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">]:</span>
            <span class="s6">#print &quot;removing item&quot;, item</span>
            <span class="s4">if </span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s3">&quot;currentSelected&quot;</span><span class="s2">) </span><span class="s4">and </span><span class="s1">self</span><span class="s2">.</span><span class="s1">currentSelected </span><span class="s4">is </span><span class="s1">item</span><span class="s2">:</span>
                <span class="s4">del </span><span class="s1">self</span><span class="s2">.</span><span class="s1">currentSelected</span>
            <span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">].</span><span class="s1">remove</span><span class="s2">(</span><span class="s1">item</span><span class="s2">)</span>
            <span class="s4">if not </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">stringType</span><span class="s2">):</span>
                <span class="s1">item</span><span class="s2">.</span><span class="s1">reparentTo</span><span class="s2">(</span><span class="s1">ShowBaseGlobal</span><span class="s2">.</span><span class="s1">hidden</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">refresh</span><span class="s2">()</span>
            <span class="s4">return </span><span class="s5">1</span>
        <span class="s4">else</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s5">0</span>

    <span class="s4">def </span><span class="s1">removeAndDestroyItem</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">item</span><span class="s2">, </span><span class="s1">refresh </span><span class="s2">= </span><span class="s5">1</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot; 
        Remove and destroy this item from the panel. 
        &quot;&quot;&quot;</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">item </span><span class="s4">in </span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">]:</span>
            <span class="s4">if </span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s3">&quot;currentSelected&quot;</span><span class="s2">) </span><span class="s4">and </span><span class="s1">self</span><span class="s2">.</span><span class="s1">currentSelected </span><span class="s4">is </span><span class="s1">item</span><span class="s2">:</span>
                <span class="s4">del </span><span class="s1">self</span><span class="s2">.</span><span class="s1">currentSelected</span>
            <span class="s4">if </span><span class="s2">(</span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s3">'destroy'</span><span class="s2">) </span><span class="s4">and </span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">item</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">, </span><span class="s3">'__call__'</span><span class="s2">)):</span>
                <span class="s1">item</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">()</span>
            <span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">].</span><span class="s1">remove</span><span class="s2">(</span><span class="s1">item</span><span class="s2">)</span>
            <span class="s4">if not </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">stringType</span><span class="s2">):</span>
                <span class="s1">item</span><span class="s2">.</span><span class="s1">reparentTo</span><span class="s2">(</span><span class="s1">ShowBaseGlobal</span><span class="s2">.</span><span class="s1">hidden</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">refresh</span><span class="s2">()</span>
            <span class="s4">return </span><span class="s5">1</span>
        <span class="s4">else</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s5">0</span>

    <span class="s4">def </span><span class="s1">removeAllItems</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">refresh</span><span class="s2">=</span><span class="s5">1</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot; 
        Remove this item from the panel 
        Warning 2006_10_19 tested only in the trolley metagame 
        &quot;&quot;&quot;</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">retval </span><span class="s2">= </span><span class="s5">0</span>
        <span class="s6">#print &quot;remove item called&quot;, item</span>
        <span class="s6">#print &quot;items list&quot;, self['items']</span>
        <span class="s4">while </span><span class="s1">len </span><span class="s2">(</span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">]):</span>
            <span class="s1">item </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'items'</span><span class="s2">][</span><span class="s5">0</span><span class="s2">]</span>
            <span class="s6">#print &quot;removing item&quot;, item</span>
            <span class="s4">if </span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s3">&quot;currentSelected&quot;</span><span class="s2">) </span><span class="s4">and </span><span class="s1">self</span><span class="s2">.</span><span class="s1">currentSelected </span><span class="s4">is </span><span class="s1">item</span><span class="s2">:</span>
                <span class="s4">del </span><span class="s1">self</span><span class="s2">.</span><span class="s1">currentSelected</span>
            <span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">].</span><span class="s1">remove</span><span class="s2">(</span><span class="s1">item</span><span class="s2">)</span>
            <span class="s4">if not </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">stringType</span><span class="s2">):</span>
                <span class="s6">#RAU possible leak here, let's try to do the right thing</span>
                <span class="s6">#item.reparentTo(ShowBaseGlobal.hidden)</span>
                <span class="s1">item</span><span class="s2">.</span><span class="s1">removeNode</span><span class="s2">()</span>
            <span class="s1">retval </span><span class="s2">= </span><span class="s5">1</span>

        <span class="s4">if </span><span class="s2">(</span><span class="s1">refresh</span><span class="s2">):</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">refresh</span><span class="s2">()</span>

        <span class="s4">return </span><span class="s1">retval</span>

    <span class="s4">def </span><span class="s1">removeAndDestroyAllItems</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">refresh </span><span class="s2">= </span><span class="s5">1</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot; 
        Remove and destroy all items from the panel. 
        Warning 2006_10_19 tested only in the trolley metagame 
        &quot;&quot;&quot;</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">retval </span><span class="s2">= </span><span class="s5">0</span>
        <span class="s4">while </span><span class="s1">len </span><span class="s2">(</span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">]):</span>
            <span class="s1">item </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'items'</span><span class="s2">][</span><span class="s5">0</span><span class="s2">]</span>
            <span class="s4">if </span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s3">&quot;currentSelected&quot;</span><span class="s2">) </span><span class="s4">and </span><span class="s1">self</span><span class="s2">.</span><span class="s1">currentSelected </span><span class="s4">is </span><span class="s1">item</span><span class="s2">:</span>
                <span class="s4">del </span><span class="s1">self</span><span class="s2">.</span><span class="s1">currentSelected</span>
            <span class="s4">if </span><span class="s2">(</span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s3">'destroy'</span><span class="s2">) </span><span class="s4">and </span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">item</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">, </span><span class="s3">'__call__'</span><span class="s2">)):</span>
                <span class="s1">item</span><span class="s2">.</span><span class="s1">destroy</span><span class="s2">()</span>
            <span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;items&quot;</span><span class="s2">].</span><span class="s1">remove</span><span class="s2">(</span><span class="s1">item</span><span class="s2">)</span>
            <span class="s4">if not </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">stringType</span><span class="s2">):</span>
                <span class="s6">#RAU possible leak here, let's try to do the right thing</span>
                <span class="s6">#item.reparentTo(ShowBaseGlobal.hidden)</span>
                <span class="s1">item</span><span class="s2">.</span><span class="s1">removeNode</span><span class="s2">()</span>
            <span class="s1">retval </span><span class="s2">= </span><span class="s5">1</span>
        <span class="s4">if </span><span class="s2">(</span><span class="s1">refresh</span><span class="s2">):</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">refresh</span><span class="s2">()</span>
        <span class="s4">return </span><span class="s1">retval</span>

    <span class="s4">def </span><span class="s1">refresh</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot; 
        Update the list - useful when adding or deleting items 
        or changing properties that would affect the scrolling 
        &quot;&quot;&quot;</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">recordMaxHeight</span><span class="s2">()</span>
        <span class="s6">#print &quot;refresh called&quot;</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">scrollTo</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">index</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">getSelectedIndex</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">index</span>

    <span class="s4">def </span><span class="s1">getSelectedText</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">self</span><span class="s2">[</span><span class="s3">'items'</span><span class="s2">][</span><span class="s1">self</span><span class="s2">.</span><span class="s1">index</span><span class="s2">], </span><span class="s1">stringType</span><span class="s2">):</span>
          <span class="s4">return </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'items'</span><span class="s2">][</span><span class="s1">self</span><span class="s2">.</span><span class="s1">index</span><span class="s2">]</span>
        <span class="s4">else</span><span class="s2">:</span>
          <span class="s4">return </span><span class="s1">self</span><span class="s2">[</span><span class="s3">'items'</span><span class="s2">][</span><span class="s1">self</span><span class="s2">.</span><span class="s1">index</span><span class="s2">][</span><span class="s3">'text'</span><span class="s2">]</span>

    <span class="s4">def </span><span class="s1">setIncButtonCallback</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">__incButtonCallback </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;incButtonCallback&quot;</span><span class="s2">]</span>

    <span class="s4">def </span><span class="s1">setDecButtonCallback</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">notify</span><span class="s2">.</span><span class="s1">debugStateCall</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">__decButtonCallback </span><span class="s2">= </span><span class="s1">self</span><span class="s2">[</span><span class="s3">&quot;decButtonCallback&quot;</span><span class="s2">]</span>


<span class="s3">&quot;&quot;&quot; 
from DirectGui import * 
 
def makeButton(itemName, itemNum, *extraArgs): 
    def buttonCommand(): 
        print itemName, itemNum 
    return DirectButton(text = itemName, 
                        relief = DGG.RAISED, 
                        frameSize = (-3.5, 3.5, -0.2, 0.8), 
                        scale = 0.85, 
                        command = buttonCommand) 
 
s = scrollList = DirectScrolledList( 
    parent = aspect2d, 
    relief = None, 
    # Use the default dialog box image as the background 
    image = DGG.getDefaultDialogGeom(), 
    # Scale it to fit around everyting 
    image_scale = (0.7, 1, .8), 
    # Give it a label 
    text = &quot;Scrolled List Example&quot;, 
    text_scale = 0.06, 
    text_align = TextNode.ACenter, 
    text_pos = (0, 0.3), 
    text_fg = (0, 0, 0, 1), 
    # inc and dec are DirectButtons 
    # They can contain a combination of text, geometry and images 
    # Just a simple text one for now 
    incButton_text = 'Increment', 
    incButton_relief = DGG.RAISED, 
    incButton_pos = (0.0, 0.0, -0.36), 
    incButton_scale = 0.1, 
    # Same for the decrement button 
    decButton_text = 'Decrement', 
    decButton_relief = DGG.RAISED, 
    decButton_pos = (0.0, 0.0, 0.175), 
    decButton_scale = 0.1, 
    # each item is a button with text on it 
    numItemsVisible = 4, 
    itemMakeFunction = makeButton, 
    items = ['Able', 'Baker', 'Charlie', 'Delta', 'Echo', 'Foxtrot', 
             'Golf', 'Hotel', 'India', 'Juliet', 'Kilo', 'Lima'], 
    # itemFrame is a DirectFrame 
    # Use it to scale up or down the items and to place it relative 
    # to eveything else 
    itemFrame_pos = (0, 0, 0.06), 
    itemFrame_scale = 0.1, 
    itemFrame_frameSize = (-3.1, 3.1, -3.3, 0.8), 
    itemFrame_relief = DGG.GROOVE, 
    ) 
&quot;&quot;&quot;</span>
</pre>
</body>
</html>