<html>
<head>
<title>ursfx.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #7a7e85;}
.s4 { color: #2aacb8;}
.s5 { color: #6aab73;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
ursfx.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">ursina </span><span class="s0">import </span><span class="s2">*</span>



<span class="s3"># def play_synth_adsr(</span>
<span class="s3">#     wave = 'sine',</span>
<span class="s3">#     max_volume = .75,</span>
<span class="s3">#     # start_volume = 0,</span>
<span class="s3">#</span>
<span class="s3">#     attack = .05,</span>
<span class="s3">#     decay = .01,             # time to fade down to sustain volume</span>
<span class="s3">#     sustain_volume = .5,     # volume of middle part relative to max volume</span>
<span class="s3">#     sustain_length = .2,     # duration of middle part</span>
<span class="s3">#     release = .2,            # fade out duration</span>
<span class="s3">#     # release_volume = None,   # default is the same as sustain</span>
<span class="s3">#     # end_volume = 0,</span>
<span class="s3">#</span>
<span class="s3">#     start_pitch = 0,</span>
<span class="s3">#     end_pitch = 2,</span>
<span class="s3">#     pitch_curve = curve.linear,</span>
<span class="s3">#     # volume_multiplier = 1</span>
<span class="s3">#</span>
<span class="s3">#         ):</span>
<span class="s3">#</span>
<span class="s3">#     total_duration = attack + decay + sustain_length + release</span>
<span class="s3">#     # if release_volume is None:</span>
<span class="s3">#     #     release_volume = sustain_volume</span>
<span class="s3">#</span>
<span class="s3">#     a = Audio(wave, loop=True, pitch=pow(1 / 1.05946309436, -pitch), volume=start_volume)</span>
<span class="s3">#     a.animate('volume', max_volume, duration=attack, curve=curve.linear)</span>
<span class="s3">#     a.animate('volume', sustain_volume*max_volume, duration=decay, delay=attack, curve=curve.linear)</span>
<span class="s3">#     a.animate('volume', sustain_volume*max_volume, duration=sustain_length, delay=attack+decay, curve=curve.linear)</span>
<span class="s3">#     a.animate('volume', 0, duration=release, delay=attack+decay+sustain_length, curve=curve.linear)</span>
<span class="s3">#</span>
<span class="s3">#     a.animate('pitch', pow(1 / 1.05946309436, -end_pitch), duration=total_duration, curve=pitch_curve)</span>
<span class="s3">#     a.animations.append(invoke(a.stop, delay=total_duration))</span>
<span class="s3">#     return a</span>


<span class="s0">def </span><span class="s1">ursfx</span><span class="s2">(</span><span class="s1">volume_curve</span><span class="s2">, </span><span class="s1">volume</span><span class="s2">=</span><span class="s4">.75</span><span class="s2">, </span><span class="s1">wave</span><span class="s2">=</span><span class="s5">'sine'</span><span class="s2">, </span><span class="s1">pitch</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">pitch_change</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">speed</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">pitch_curve</span><span class="s2">=</span><span class="s1">curve</span><span class="s2">.</span><span class="s1">linear</span><span class="s2">):  </span><span class="s3"># play a retro style sound effect</span>
    <span class="s1">a </span><span class="s2">= </span><span class="s1">Audio</span><span class="s2">(</span><span class="s1">wave</span><span class="s2">, </span><span class="s1">loop</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">pitch</span><span class="s2">=</span><span class="s1">pow</span><span class="s2">(</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">1.05946309436</span><span class="s2">, -</span><span class="s1">pitch</span><span class="s2">), </span><span class="s1">volume</span><span class="s2">=</span><span class="s1">volume_curve</span><span class="s2">[</span><span class="s4">0</span><span class="s2">][</span><span class="s4">1</span><span class="s2">] * </span><span class="s1">volume</span><span class="s2">)</span>

    <span class="s1">cumulative_time </span><span class="s2">= </span><span class="s4">0</span>
    <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">volume_curve</span><span class="s2">)-</span><span class="s4">1</span><span class="s2">):</span>
        <span class="s1">a</span><span class="s2">.</span><span class="s1">animate</span><span class="s2">(</span><span class="s5">'volume'</span><span class="s2">, </span><span class="s1">volume_curve</span><span class="s2">[</span><span class="s1">i</span><span class="s2">+</span><span class="s4">1</span><span class="s2">][</span><span class="s4">1</span><span class="s2">] * </span><span class="s1">volume</span><span class="s2">, </span><span class="s1">duration</span><span class="s2">=(</span><span class="s1">volume_curve</span><span class="s2">[</span><span class="s1">i</span><span class="s2">+</span><span class="s4">1</span><span class="s2">][</span><span class="s4">0</span><span class="s2">] - </span><span class="s1">volume_curve</span><span class="s2">[</span><span class="s1">i</span><span class="s2">][</span><span class="s4">0</span><span class="s2">]) / </span><span class="s1">speed</span><span class="s2">, </span><span class="s1">delay</span><span class="s2">=</span><span class="s1">volume_curve</span><span class="s2">[</span><span class="s1">i</span><span class="s2">][</span><span class="s4">0</span><span class="s2">] / </span><span class="s1">speed</span><span class="s2">, </span><span class="s1">curve</span><span class="s2">=</span><span class="s1">curve</span><span class="s2">.</span><span class="s1">linear</span><span class="s2">)</span>

    <span class="s1">a</span><span class="s2">.</span><span class="s1">animate</span><span class="s2">(</span><span class="s5">'pitch'</span><span class="s2">, </span><span class="s1">pow</span><span class="s2">(</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">1.05946309436</span><span class="s2">, -</span><span class="s1">pitch</span><span class="s2">-</span><span class="s1">pitch_change</span><span class="s2">), </span><span class="s1">duration</span><span class="s2">=</span><span class="s1">volume_curve</span><span class="s2">[</span><span class="s1">i</span><span class="s2">-</span><span class="s4">1</span><span class="s2">][</span><span class="s4">0</span><span class="s2">] / </span><span class="s1">speed</span><span class="s2">, </span><span class="s1">curve</span><span class="s2">=</span><span class="s1">pitch_curve</span><span class="s2">)</span>
    <span class="s1">a</span><span class="s2">.</span><span class="s1">animations</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">invoke</span><span class="s2">(</span><span class="s1">a</span><span class="s2">.</span><span class="s1">stop</span><span class="s2">, </span><span class="s1">delay</span><span class="s2">=</span><span class="s1">volume_curve</span><span class="s2">[</span><span class="s4">4</span><span class="s2">][</span><span class="s4">0</span><span class="s2">] / </span><span class="s1">speed</span><span class="s2">))</span>

    <span class="s1">invoke</span><span class="s2">(</span><span class="s1">a</span><span class="s2">.</span><span class="s1">stop</span><span class="s2">, </span><span class="s1">delay</span><span class="s2">=</span><span class="s1">volume_curve</span><span class="s2">[</span><span class="s4">4</span><span class="s2">][</span><span class="s4">0</span><span class="s2">] / </span><span class="s1">speed</span><span class="s2">)</span>
    <span class="s0">return </span><span class="s1">a</span>


<span class="s0">class </span><span class="s1">UrsfxGUI</span><span class="s2">(</span><span class="s1">Entity</span><span class="s2">):</span>
    <span class="s0">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">):</span>
        <span class="s1">super</span><span class="s2">().</span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">parent</span><span class="s2">=</span><span class="s1">camera</span><span class="s2">.</span><span class="s1">ui</span><span class="s2">, </span><span class="s1">z</span><span class="s2">=-</span><span class="s4">998</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">)</span>

        <span class="s1">default_positions </span><span class="s2">= [(</span><span class="s4">0</span><span class="s2">,</span><span class="s4">0</span><span class="s2">), (</span><span class="s4">.1</span><span class="s2">,</span><span class="s4">.9</span><span class="s2">), (</span><span class="s4">.15</span><span class="s2">,</span><span class="s4">.75</span><span class="s2">), (</span><span class="s4">.6</span><span class="s2">,</span><span class="s4">.75</span><span class="s2">), (</span><span class="s4">1</span><span class="s2">,</span><span class="s4">0</span><span class="s2">)]</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel </span><span class="s2">= </span><span class="s1">Entity</span><span class="s2">(</span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">.35</span><span class="s2">, </span><span class="s1">x</span><span class="s2">=-</span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">waveform </span><span class="s2">= </span><span class="s1">Entity</span><span class="s2">(</span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">, </span><span class="s1">scale_y</span><span class="s2">=</span><span class="s4">.75</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">waveform_bg </span><span class="s2">= </span><span class="s1">Entity</span><span class="s2">(</span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">waveform</span><span class="s2">, </span><span class="s1">model</span><span class="s2">=</span><span class="s5">'quad'</span><span class="s2">, </span><span class="s1">origin</span><span class="s2">=(-</span><span class="s4">.5</span><span class="s2">,-</span><span class="s4">.5</span><span class="s2">), </span><span class="s1">z</span><span class="s2">=</span><span class="s4">.01</span><span class="s2">, </span><span class="s1">color</span><span class="s2">=</span><span class="s1">color</span><span class="s2">.</span><span class="s1">black66</span><span class="s2">)</span>
        <span class="s3"># self.bg_2 = Entity(parent=self.waveform, model='quad', origin=(-.5,-.5), z=.01, color=color._16)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">volume_slider </span><span class="s2">= </span><span class="s1">Slider</span><span class="s2">(</span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">, </span><span class="s1">x</span><span class="s2">=-</span><span class="s4">.05</span><span class="s2">, </span><span class="s1">vertical</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">1.95</span><span class="s2">, </span><span class="s1">min</span><span class="s2">=</span><span class="s4">.05</span><span class="s2">, </span><span class="s1">max</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">default</span><span class="s2">=</span><span class="s4">.75</span><span class="s2">, </span><span class="s1">step</span><span class="s2">=</span><span class="s4">.01</span><span class="s2">, </span><span class="s1">on_value_changed</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">play</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">wave_selector </span><span class="s2">= </span><span class="s1">ButtonGroup</span><span class="s2">((</span><span class="s5">'sine'</span><span class="s2">, </span><span class="s5">'triangle'</span><span class="s2">, </span><span class="s5">'square'</span><span class="s2">, </span><span class="s5">'noise'</span><span class="s2">), </span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">.11</span><span class="s2">, </span><span class="s1">y</span><span class="s2">=-</span><span class="s4">.075</span><span class="s2">)</span>
        <span class="s0">for </span><span class="s1">e </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_selector</span><span class="s2">.</span><span class="s1">buttons</span><span class="s2">:</span>
            <span class="s1">e</span><span class="s2">.</span><span class="s1">text_entity</span><span class="s2">.</span><span class="s1">world_scale </span><span class="s2">= </span><span class="s4">.5</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">pitch_slider </span><span class="s2">= </span><span class="s1">Slider</span><span class="s2">(</span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">, </span><span class="s1">y</span><span class="s2">=-</span><span class="s4">.25</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">1.95</span><span class="s2">, </span><span class="s1">min</span><span class="s2">=-</span><span class="s4">36</span><span class="s2">, </span><span class="s1">max</span><span class="s2">=</span><span class="s4">36</span><span class="s2">, </span><span class="s1">default</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">step</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">on_value_changed</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">play</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s5">'pitch'</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">pitch_change_slider </span><span class="s2">=  </span><span class="s1">Slider</span><span class="s2">(</span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">, </span><span class="s1">y</span><span class="s2">=-</span><span class="s4">.325</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">1.95</span><span class="s2">, </span><span class="s1">min</span><span class="s2">=-</span><span class="s4">12</span><span class="s2">, </span><span class="s1">max</span><span class="s2">=</span><span class="s4">12</span><span class="s2">, </span><span class="s1">default</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">step</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">on_value_changed</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">play</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s5">'pitch change'</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">speed_slider </span><span class="s2">=  </span><span class="s1">Slider</span><span class="s2">(</span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">1.95</span><span class="s2">, </span><span class="s1">min</span><span class="s2">=</span><span class="s4">.5</span><span class="s2">, </span><span class="s1">max</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">default</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">step</span><span class="s2">=</span><span class="s4">.1</span><span class="s2">, </span><span class="s1">on_value_changed</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">play</span><span class="s2">, </span><span class="s1">y</span><span class="s2">=-</span><span class="s4">.4</span><span class="s2">, </span><span class="s1">text</span><span class="s2">=</span><span class="s5">'speed'</span><span class="s2">)</span>

        <span class="s0">def </span><span class="s1">coin_sound</span><span class="s2">():</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">paste_code</span><span class="s2">(</span><span class="s5">f&quot;ursfx([(0,1), (</span><span class="s0">{</span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">(</span><span class="s4">.05</span><span class="s2">,</span><span class="s4">.15</span><span class="s2">)</span><span class="s0">}</span><span class="s5">,.5), (.25,.5), (</span><span class="s0">{</span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">(</span><span class="s4">.25</span><span class="s2">,</span><span class="s4">.5</span><span class="s2">)</span><span class="s0">}</span><span class="s5">,.5), (1,0)], pitch=</span><span class="s0">{</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(-</span><span class="s4">3</span><span class="s2">, </span><span class="s4">24</span><span class="s2">)</span><span class="s0">}</span><span class="s5">, speed=</span><span class="s0">{</span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">(</span><span class="s4">2.5</span><span class="s2">,</span><span class="s4">3</span><span class="s2">)</span><span class="s0">}</span><span class="s5">)&quot;</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">play</span><span class="s2">()</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">coin_button </span><span class="s2">= </span><span class="s1">Button</span><span class="s2">(</span><span class="s1">text</span><span class="s2">=</span><span class="s5">'coin'</span><span class="s2">, </span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=(</span><span class="s4">.25</span><span class="s2">, </span><span class="s4">.125</span><span class="s2">), </span><span class="s1">origin</span><span class="s2">=(-</span><span class="s4">.5</span><span class="s2">,</span><span class="s4">.5</span><span class="s2">), </span><span class="s1">y</span><span class="s2">=-</span><span class="s4">.45</span><span class="s2">, </span><span class="s1">on_click</span><span class="s2">=</span><span class="s1">coin_sound</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">knobs </span><span class="s2">= [</span><span class="s1">Draggable</span><span class="s2">(</span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">waveform</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">.05</span><span class="s2">, </span><span class="s1">model</span><span class="s2">=</span><span class="s5">'circle'</span><span class="s2">, </span><span class="s1">color</span><span class="s2">=</span><span class="s1">color</span><span class="s2">.</span><span class="s1">light_gray</span><span class="s2">, </span><span class="s1">highlight_color</span><span class="s2">=</span><span class="s1">color</span><span class="s2">.</span><span class="s1">azure</span><span class="s2">, </span><span class="s1">position</span><span class="s2">=</span><span class="s1">default_positions</span><span class="s2">[</span><span class="s1">i</span><span class="s2">], </span><span class="s1">i</span><span class="s2">=</span><span class="s1">i</span><span class="s2">, </span><span class="s1">min_y</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">max_y</span><span class="s2">=</span><span class="s4">1</span><span class="s2">) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s4">5</span><span class="s2">)]</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">[</span><span class="s4">0</span><span class="s2">].</span><span class="s1">lock </span><span class="s2">= (</span><span class="s0">True</span><span class="s2">,</span><span class="s0">False</span><span class="s2">,</span><span class="s0">True</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">line </span><span class="s2">= </span><span class="s1">Entity</span><span class="s2">(</span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">waveform</span><span class="s2">, </span><span class="s1">model</span><span class="s2">=</span><span class="s1">Mesh</span><span class="s2">(</span><span class="s1">vertices</span><span class="s2">=[</span><span class="s1">Vec3</span><span class="s2">(</span><span class="s4">0</span><span class="s2">,</span><span class="s4">0</span><span class="s2">,</span><span class="s4">0</span><span class="s2">), </span><span class="s1">Vec3</span><span class="s2">(</span><span class="s4">1</span><span class="s2">,</span><span class="s4">0</span><span class="s2">,</span><span class="s4">0</span><span class="s2">)], </span><span class="s1">mode</span><span class="s2">=</span><span class="s5">'line'</span><span class="s2">, </span><span class="s1">thickness</span><span class="s2">=</span><span class="s4">3</span><span class="s2">), </span><span class="s1">z</span><span class="s2">=</span><span class="s4">.01</span><span class="s2">, </span><span class="s1">color</span><span class="s2">=</span><span class="s1">color</span><span class="s2">.</span><span class="s1">light_gray</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">bg </span><span class="s2">= </span><span class="s1">Entity</span><span class="s2">(</span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">, </span><span class="s1">model</span><span class="s2">=</span><span class="s5">'wireframe_quad'</span><span class="s2">, </span><span class="s1">origin</span><span class="s2">=(-</span><span class="s4">.5</span><span class="s2">,-</span><span class="s4">.5</span><span class="s2">), </span><span class="s1">z</span><span class="s2">=</span><span class="s4">.02</span><span class="s2">, </span><span class="s1">color</span><span class="s2">=</span><span class="s1">color</span><span class="s2">.</span><span class="s1">black</span><span class="s2">, </span><span class="s1">scale_x</span><span class="s2">=</span><span class="s4">1</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">play_button </span><span class="s2">= </span><span class="s1">Button</span><span class="s2">(</span><span class="s1">text</span><span class="s2">=</span><span class="s5">'&gt;'</span><span class="s2">, </span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">, </span><span class="s1">model</span><span class="s2">=</span><span class="s5">'circle'</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=(</span><span class="s4">.125</span><span class="s2">, </span><span class="s4">.125</span><span class="s2">), </span><span class="s1">color</span><span class="s2">=</span><span class="s1">color</span><span class="s2">.</span><span class="s1">azure</span><span class="s2">, </span><span class="s1">origin</span><span class="s2">=(-</span><span class="s4">.5</span><span class="s2">,-</span><span class="s4">.5</span><span class="s2">), </span><span class="s1">position</span><span class="s2">=(-</span><span class="s4">.075</span><span class="s2">,</span><span class="s4">1.025</span><span class="s2">), </span><span class="s1">on_click</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">play</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">copy_button </span><span class="s2">= </span><span class="s1">Button</span><span class="s2">(</span><span class="s1">text</span><span class="s2">=</span><span class="s5">'copy'</span><span class="s2">, </span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=(</span><span class="s4">.25</span><span class="s2">, </span><span class="s4">.125</span><span class="s2">), </span><span class="s1">color</span><span class="s2">=</span><span class="s1">color</span><span class="s2">.</span><span class="s1">dark_gray</span><span class="s2">, </span><span class="s1">origin</span><span class="s2">=(-</span><span class="s4">.5</span><span class="s2">,-</span><span class="s4">.5</span><span class="s2">), </span><span class="s1">position</span><span class="s2">=(-</span><span class="s4">.075</span><span class="s2">+</span><span class="s4">.125</span><span class="s2">+</span><span class="s4">.025</span><span class="s2">, </span><span class="s4">1.025</span><span class="s2">), </span><span class="s1">on_click</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">copy_code</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">copy_button</span><span class="s2">.</span><span class="s1">text_entity</span><span class="s2">.</span><span class="s1">scale </span><span class="s2">*= </span><span class="s4">.5</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">paste_button </span><span class="s2">= </span><span class="s1">Button</span><span class="s2">(</span><span class="s1">text</span><span class="s2">=</span><span class="s5">'paste'</span><span class="s2">, </span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=(</span><span class="s4">.25</span><span class="s2">, </span><span class="s4">.125</span><span class="s2">), </span><span class="s1">color</span><span class="s2">=</span><span class="s1">color</span><span class="s2">.</span><span class="s1">dark_gray</span><span class="s2">, </span><span class="s1">origin</span><span class="s2">=(-</span><span class="s4">.5</span><span class="s2">,-</span><span class="s4">.5</span><span class="s2">), </span><span class="s1">position</span><span class="s2">=(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">copy_button</span><span class="s2">.</span><span class="s1">x </span><span class="s2">+ </span><span class="s1">self</span><span class="s2">.</span><span class="s1">copy_button</span><span class="s2">.</span><span class="s1">scale_x </span><span class="s2">+ </span><span class="s4">.025</span><span class="s2">, </span><span class="s4">1.025</span><span class="s2">), </span><span class="s1">on_click</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">paste_code</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">paste_button</span><span class="s2">.</span><span class="s1">text_entity</span><span class="s2">.</span><span class="s1">scale </span><span class="s2">*= </span><span class="s4">.5</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">code_text </span><span class="s2">= </span><span class="s1">Text</span><span class="s2">(</span><span class="s5">''</span><span class="s2">, </span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">position</span><span class="s2">=(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">paste_button</span><span class="s2">.</span><span class="s1">x</span><span class="s2">+</span><span class="s1">self</span><span class="s2">.</span><span class="s1">paste_button</span><span class="s2">.</span><span class="s1">scale_x</span><span class="s2">+</span><span class="s4">.025</span><span class="s2">,</span><span class="s4">1.11</span><span class="s2">))</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">wave_selector</span><span class="s2">.</span><span class="s1">on_value_changed </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">play</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">background_panel </span><span class="s2">= </span><span class="s1">Entity</span><span class="s2">(</span><span class="s1">model</span><span class="s2">=</span><span class="s1">Quad</span><span class="s2">(</span><span class="s1">radius</span><span class="s2">=</span><span class="s4">.025</span><span class="s2">), </span><span class="s1">parent</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">, </span><span class="s1">color</span><span class="s2">=</span><span class="s1">color</span><span class="s2">.</span><span class="s1">black66</span><span class="s2">, </span><span class="s1">z</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">origin</span><span class="s2">=(-</span><span class="s4">.5</span><span class="s2">,-</span><span class="s4">.5</span><span class="s2">), </span><span class="s1">scale</span><span class="s2">=(</span><span class="s4">1.125</span><span class="s2">,</span><span class="s4">1.75</span><span class="s2">+</span><span class="s4">.025</span><span class="s2">), </span><span class="s1">position</span><span class="s2">=(-</span><span class="s4">.1</span><span class="s2">,-</span><span class="s4">.6</span><span class="s2">))</span>

        <span class="s0">for </span><span class="s1">i</span><span class="s2">, </span><span class="s1">knob </span><span class="s0">in </span><span class="s1">enumerate</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">):</span>
            <span class="s0">def </span><span class="s1">drag</span><span class="s2">(</span><span class="s1">this_knob</span><span class="s2">=</span><span class="s1">knob</span><span class="s2">):</span>
                <span class="s0">if </span><span class="s1">this_knob</span><span class="s2">.</span><span class="s1">i </span><span class="s2">== </span><span class="s4">0</span><span class="s2">:</span>
                    <span class="s1">this_knob</span><span class="s2">.</span><span class="s1">min_x </span><span class="s2">= </span><span class="s4">0</span>
                <span class="s0">else</span><span class="s2">:</span>
                    <span class="s1">print</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">[</span><span class="s1">this_knob</span><span class="s2">.</span><span class="s1">i </span><span class="s2">- </span><span class="s4">1</span><span class="s2">].</span><span class="s1">x</span><span class="s2">)</span>
                    <span class="s1">this_knob</span><span class="s2">.</span><span class="s1">min_x </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">[</span><span class="s1">this_knob</span><span class="s2">.</span><span class="s1">i </span><span class="s2">- </span><span class="s4">1</span><span class="s2">].</span><span class="s1">x </span><span class="s2">+ </span><span class="s4">.01</span>

                <span class="s0">if </span><span class="s1">this_knob</span><span class="s2">.</span><span class="s1">i </span><span class="s2">== </span><span class="s4">4</span><span class="s2">:</span>
                    <span class="s1">this_knob</span><span class="s2">.</span><span class="s1">max_x </span><span class="s2">= </span><span class="s4">3</span>
                <span class="s0">else</span><span class="s2">:</span>
                    <span class="s1">this_knob</span><span class="s2">.</span><span class="s1">max_x </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">[</span><span class="s1">this_knob</span><span class="s2">.</span><span class="s1">i </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">].</span><span class="s1">x </span><span class="s2">- </span><span class="s4">.01</span>

            <span class="s1">knob</span><span class="s2">.</span><span class="s1">drag </span><span class="s2">= </span><span class="s1">drag</span>

            <span class="s0">def </span><span class="s1">drop</span><span class="s2">(</span><span class="s1">this_knob</span><span class="s2">=</span><span class="s1">knob</span><span class="s2">):</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">play</span><span class="s2">()</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">bg</span><span class="s2">.</span><span class="s1">scale_x </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">[</span><span class="s4">4</span><span class="s2">].</span><span class="s1">x</span>

                <span class="s0">for </span><span class="s1">e </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">:</span>
                    <span class="s1">e</span><span class="s2">.</span><span class="s1">min_x </span><span class="s2">= -</span><span class="s4">0</span>
                    <span class="s1">e</span><span class="s2">.</span><span class="s1">max_x </span><span class="s2">= </span><span class="s4">3</span>

            <span class="s1">knob</span><span class="s2">.</span><span class="s1">drop </span><span class="s2">= </span><span class="s1">drop</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">draw</span><span class="s2">()</span>


    <span class="s0">def </span><span class="s1">update</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">e </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">:</span>
            <span class="s1">e</span><span class="s2">.</span><span class="s1">world_scale </span><span class="s2">= </span><span class="s4">.25</span>
        <span class="s0">if </span><span class="s1">sum</span><span class="s2">(</span><span class="s1">int</span><span class="s2">(</span><span class="s1">e</span><span class="s2">.</span><span class="s1">dragging</span><span class="s2">) </span><span class="s0">for </span><span class="s1">e </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">) == </span><span class="s4">0</span><span class="s2">:</span>
            <span class="s0">return</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">draw</span><span class="s2">()</span>


    <span class="s0">def </span><span class="s1">input</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">key</span><span class="s2">):</span>
        <span class="s0">if </span><span class="s1">held_keys</span><span class="s2">[</span><span class="s5">'control'</span><span class="s2">] </span><span class="s0">and </span><span class="s1">key </span><span class="s2">== </span><span class="s5">'v' </span><span class="s0">and </span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_panel</span><span class="s2">.</span><span class="s1">enabled</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">paste_code</span><span class="s2">()</span>


    <span class="s0">def </span><span class="s1">copy_code</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">recipe</span><span class="s2">)</span>
        <span class="s0">import </span><span class="s1">pyperclip</span>
        <span class="s1">pyperclip</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">recipe</span><span class="s2">)</span>


    <span class="s0">def </span><span class="s1">paste_code</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">code</span><span class="s2">=</span><span class="s5">&quot;&quot;</span><span class="s2">):</span>
        <span class="s0">import </span><span class="s1">pyperclip</span>
        <span class="s0">if not </span><span class="s1">code</span><span class="s2">:</span>
            <span class="s1">code </span><span class="s2">= </span><span class="s1">pyperclip</span><span class="s2">.</span><span class="s1">paste</span><span class="s2">()</span>

        <span class="s1">print</span><span class="s2">(</span><span class="s5">'paste code:'</span><span class="s2">, </span><span class="s1">code</span><span class="s2">)</span>
        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">curve </span><span class="s2">= </span><span class="s1">code</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s5">'ursfx('</span><span class="s2">)[</span><span class="s4">1</span><span class="s2">].</span><span class="s1">split</span><span class="s2">(</span><span class="s5">']'</span><span class="s2">)[</span><span class="s4">0</span><span class="s2">] + </span><span class="s5">']'</span>
            <span class="s1">curve </span><span class="s2">= </span><span class="s1">eval</span><span class="s2">(</span><span class="s1">curve</span><span class="s2">)</span>
            <span class="s0">for </span><span class="s1">i</span><span class="s2">, </span><span class="s1">e </span><span class="s0">in </span><span class="s1">enumerate</span><span class="s2">(</span><span class="s1">curve</span><span class="s2">):</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">[</span><span class="s1">i</span><span class="s2">].</span><span class="s1">position</span><span class="s2">=(</span><span class="s1">e</span><span class="s2">)</span>
            <span class="s1">print</span><span class="s2">(</span><span class="s5">'--------curve'</span><span class="s2">, </span><span class="s1">curve</span><span class="s2">)</span>

            <span class="s1">volume </span><span class="s2">= </span><span class="s4">.75</span>
            <span class="s0">if </span><span class="s5">'volume=' </span><span class="s0">in </span><span class="s1">code</span><span class="s2">:</span>
                <span class="s1">volume </span><span class="s2">= </span><span class="s1">code</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s5">'volume='</span><span class="s2">)[</span><span class="s4">1</span><span class="s2">].</span><span class="s1">split</span><span class="s2">(</span><span class="s5">','</span><span class="s2">)[</span><span class="s4">0</span><span class="s2">]</span>
                <span class="s1">volume </span><span class="s2">= </span><span class="s1">eval</span><span class="s2">(</span><span class="s1">volume</span><span class="s2">)</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">volume_slider</span><span class="s2">.</span><span class="s1">value </span><span class="s2">= </span><span class="s1">volume</span>
                <span class="s1">print</span><span class="s2">(</span><span class="s5">'--------volume'</span><span class="s2">, </span><span class="s1">volume</span><span class="s2">)</span>

            <span class="s1">wave </span><span class="s2">= </span><span class="s5">'sine'</span>
            <span class="s0">if </span><span class="s5">'wave=' </span><span class="s0">in </span><span class="s1">code</span><span class="s2">:</span>
                <span class="s1">wave </span><span class="s2">= </span><span class="s1">code</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s5">'wave='</span><span class="s2">)[</span><span class="s4">1</span><span class="s2">].</span><span class="s1">split</span><span class="s2">(</span><span class="s5">','</span><span class="s2">)[</span><span class="s4">0</span><span class="s2">]</span>
                <span class="s1">wave </span><span class="s2">= </span><span class="s1">eval</span><span class="s2">(</span><span class="s1">wave</span><span class="s2">)</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">wave_selector</span><span class="s2">.</span><span class="s1">value </span><span class="s2">= </span><span class="s1">wave</span>
                <span class="s1">print</span><span class="s2">(</span><span class="s5">'--------wave'</span><span class="s2">, </span><span class="s1">wave</span><span class="s2">)</span>

            <span class="s1">pitch </span><span class="s2">= </span><span class="s4">1</span>
            <span class="s0">if </span><span class="s5">'pitch=' </span><span class="s0">in </span><span class="s1">code</span><span class="s2">:</span>
                <span class="s1">pitch </span><span class="s2">= </span><span class="s1">code</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s5">'pitch='</span><span class="s2">)[</span><span class="s4">1</span><span class="s2">]</span>
                <span class="s0">if </span><span class="s5">',' </span><span class="s0">in </span><span class="s1">pitch</span><span class="s2">:</span>
                    <span class="s1">pitch </span><span class="s2">= </span><span class="s1">pitch</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s5">','</span><span class="s2">)[</span><span class="s4">0</span><span class="s2">]</span>
                <span class="s0">else</span><span class="s2">:</span>
                    <span class="s1">pitch </span><span class="s2">= </span><span class="s1">pitch</span><span class="s2">[:-</span><span class="s4">1</span><span class="s2">]</span>
                <span class="s1">pitch </span><span class="s2">= </span><span class="s1">eval</span><span class="s2">(</span><span class="s1">pitch</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">pitch_slider</span><span class="s2">.</span><span class="s1">value </span><span class="s2">= </span><span class="s1">pitch</span>
            <span class="s1">print</span><span class="s2">(</span><span class="s5">'--------pitch'</span><span class="s2">, </span><span class="s1">pitch</span><span class="s2">)</span>


            <span class="s1">pitch_change </span><span class="s2">= </span><span class="s4">0</span>
            <span class="s0">if </span><span class="s5">'pitch_change=' </span><span class="s0">in </span><span class="s1">code</span><span class="s2">:</span>
                <span class="s1">pitch_change </span><span class="s2">= </span><span class="s1">code</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s5">'pitch_change='</span><span class="s2">)[</span><span class="s4">1</span><span class="s2">]</span>
                <span class="s0">if </span><span class="s5">',' </span><span class="s0">in </span><span class="s1">pitch_change</span><span class="s2">:</span>
                    <span class="s1">pitch_change </span><span class="s2">= </span><span class="s1">pitch_change</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s5">','</span><span class="s2">)[</span><span class="s4">0</span><span class="s2">]</span>
                <span class="s0">else</span><span class="s2">:</span>
                    <span class="s1">pitch_change </span><span class="s2">= </span><span class="s1">pitch_change</span><span class="s2">[:-</span><span class="s4">1</span><span class="s2">]</span>
                <span class="s1">pitch_change </span><span class="s2">= </span><span class="s1">eval</span><span class="s2">(</span><span class="s1">pitch_change</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">pitch_change_slider</span><span class="s2">.</span><span class="s1">value </span><span class="s2">= </span><span class="s1">pitch_change</span>
            <span class="s1">print</span><span class="s2">(</span><span class="s5">'--------pitch_change'</span><span class="s2">)</span>

            <span class="s1">speed </span><span class="s2">= </span><span class="s4">1</span>
            <span class="s0">if </span><span class="s5">'speed=' </span><span class="s0">in </span><span class="s1">code</span><span class="s2">:</span>
                <span class="s1">speed </span><span class="s2">= </span><span class="s1">code</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s5">'speed='</span><span class="s2">)[</span><span class="s4">1</span><span class="s2">]</span>
                <span class="s0">if </span><span class="s5">',' </span><span class="s0">in </span><span class="s1">speed</span><span class="s2">:</span>
                    <span class="s1">speed </span><span class="s2">= </span><span class="s1">speed</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s5">','</span><span class="s2">)[</span><span class="s4">0</span><span class="s2">]</span>
                <span class="s0">else</span><span class="s2">:</span>
                    <span class="s1">speed </span><span class="s2">= </span><span class="s1">speed</span><span class="s2">[:-</span><span class="s4">1</span><span class="s2">]</span>
                <span class="s1">speed </span><span class="s2">= </span><span class="s1">eval</span><span class="s2">(</span><span class="s1">speed</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">speed_slider</span><span class="s2">.</span><span class="s1">value </span><span class="s2">= </span><span class="s1">speed</span>
            <span class="s1">print</span><span class="s2">(</span><span class="s5">'--------speed'</span><span class="s2">)</span>


            <span class="s1">print</span><span class="s2">(</span><span class="s1">curve</span><span class="s2">, </span><span class="s1">volume</span><span class="s2">, </span><span class="s1">wave</span><span class="s2">, </span><span class="s1">pitch</span><span class="s2">, </span><span class="s1">pitch_change</span><span class="s2">, </span><span class="s1">speed</span><span class="s2">)</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">draw</span><span class="s2">()</span>

        <span class="s0">except</span><span class="s2">:</span>
            <span class="s1">print</span><span class="s2">(</span><span class="s5">'invalid ursfx code:'</span><span class="s2">, </span><span class="s1">code</span><span class="s2">)</span>


    <span class="s2">@</span><span class="s1">property</span>
    <span class="s0">def </span><span class="s1">recipe</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pitch_code </span><span class="s2">= </span><span class="s5">''</span>
        <span class="s0">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">pitch_slider</span><span class="s2">.</span><span class="s1">value</span><span class="s2">:</span>
            <span class="s1">pitch_code </span><span class="s2">= </span><span class="s5">f', pitch=</span><span class="s0">{</span><span class="s1">self</span><span class="s2">.</span><span class="s1">pitch_slider</span><span class="s2">.</span><span class="s1">value</span><span class="s0">}</span><span class="s5">'</span>

        <span class="s1">pitch_change_code </span><span class="s2">= </span><span class="s5">''</span>
        <span class="s0">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">pitch_change_slider</span><span class="s2">.</span><span class="s1">value</span><span class="s2">:</span>
            <span class="s1">pitch_change_code </span><span class="s2">= </span><span class="s5">f', pitch_change=</span><span class="s0">{</span><span class="s1">self</span><span class="s2">.</span><span class="s1">pitch_change_slider</span><span class="s2">.</span><span class="s1">value</span><span class="s0">}</span><span class="s5">'</span>

        <span class="s1">speed_code </span><span class="s2">= </span><span class="s5">''</span>
        <span class="s0">if </span><span class="s1">speed_code </span><span class="s2">!= </span><span class="s4">1</span><span class="s2">:</span>
            <span class="s1">speed_code </span><span class="s2">= </span><span class="s5">f', speed=</span><span class="s0">{</span><span class="s1">round</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">speed_slider</span><span class="s2">.</span><span class="s1">value</span><span class="s2">, </span><span class="s4">1</span><span class="s2">)</span><span class="s0">}</span><span class="s5">'</span>

        <span class="s0">return </span><span class="s5">f&quot;ursfx(</span><span class="s0">{</span><span class="s1">str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">volume_curve</span><span class="s2">)</span><span class="s0">}</span><span class="s5">, volume=</span><span class="s0">{</span><span class="s1">round</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">volume_slider</span><span class="s2">.</span><span class="s1">value</span><span class="s2">,</span><span class="s4">3</span><span class="s2">)</span><span class="s0">}</span><span class="s5">, wave='</span><span class="s0">{</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_selector</span><span class="s2">.</span><span class="s1">value</span><span class="s0">}</span><span class="s5">'</span><span class="s0">{</span><span class="s1">pitch_code</span><span class="s0">}{</span><span class="s1">pitch_change_code</span><span class="s0">}{</span><span class="s1">speed_code</span><span class="s0">}</span><span class="s5">)&quot;</span>






    <span class="s0">def </span><span class="s1">draw</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># self.bg.scale_x = self.knobs[4].x</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">waveform_bg</span><span class="s2">.</span><span class="s1">scale_x </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">[</span><span class="s4">4</span><span class="s2">].</span><span class="s1">x</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">bg</span><span class="s2">.</span><span class="s1">scale_x </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">[</span><span class="s4">4</span><span class="s2">].</span><span class="s1">x</span>

        <span class="s0">for </span><span class="s1">e </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">:</span>
            <span class="s1">e</span><span class="s2">.</span><span class="s1">position </span><span class="s2">= (</span><span class="s1">round</span><span class="s2">(</span><span class="s1">e</span><span class="s2">.</span><span class="s1">x</span><span class="s2">,</span><span class="s4">2</span><span class="s2">), </span><span class="s1">round</span><span class="s2">(</span><span class="s1">e</span><span class="s2">.</span><span class="s1">y</span><span class="s2">,</span><span class="s4">2</span><span class="s2">))</span>


        <span class="s1">self</span><span class="s2">.</span><span class="s1">line</span><span class="s2">.</span><span class="s1">model</span><span class="s2">.</span><span class="s1">vertices </span><span class="s2">= [</span><span class="s1">e</span><span class="s2">.</span><span class="s1">get_position</span><span class="s2">(</span><span class="s1">relative_to</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">waveform</span><span class="s2">) </span><span class="s0">for </span><span class="s1">e </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">]</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">line</span><span class="s2">.</span><span class="s1">model</span><span class="s2">.</span><span class="s1">generate</span><span class="s2">()</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">volume_curve </span><span class="s2">= [</span><span class="s1">e</span><span class="s2">.</span><span class="s1">get_position</span><span class="s2">(</span><span class="s1">relative_to</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">waveform</span><span class="s2">) </span><span class="s0">for </span><span class="s1">e </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">]</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">volume_curve </span><span class="s2">= [(</span><span class="s1">round</span><span class="s2">(</span><span class="s1">e</span><span class="s2">[</span><span class="s4">0</span><span class="s2">],</span><span class="s4">2</span><span class="s2">), </span><span class="s1">round</span><span class="s2">(</span><span class="s1">e</span><span class="s2">[</span><span class="s4">1</span><span class="s2">],</span><span class="s4">2</span><span class="s2">)) </span><span class="s0">for </span><span class="s1">e </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">volume_curve</span><span class="s2">]</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">waveform</span><span class="s2">.</span><span class="s1">scale_y </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">volume_slider</span><span class="s2">.</span><span class="s1">value</span>
        <span class="s3"># self.code_text.text = f&quot;ursfx({str(self.volume_curve)}, {round(self.volume_slider.value,3)}, wave='{self.wave_selector.value}', pitch={self.pitch_slider.value}, end_pitch={self.pitch_slider.value+self.pitch_change_slider.value})&quot;</span>


    <span class="s0">def </span><span class="s1">play</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">draw</span><span class="s2">()</span>
        <span class="s3"># ursfx([(0.0, 0.0), (0.02, 0.89), (0.08, 0.63), (0.15, 0.27), (0.19, 0.0)], volume=0.75, wave='noise', pitch=-12, pitch_change=-9)</span>
        <span class="s3"># select = ursfx([(0.0, 0.0), (0.03, 0.9), (0.04, 0.75), (0.08, 0.25), (0.2, 0.0)], volume=0.75, wave='triangle', pitch=2, pitch_change=12)</span>
        <span class="s3"># select_2 = ursfx([(0.0, 0.0), (0.03, 0.9), (0.04, 0.75), (0.07, 0.18), (0.25, 0.0)], volume=0.86, wave='triangle', pitch=1, pitch_change=7)</span>
        <span class="s3"># hurt = ursfx([(0.0, 0.0), (0.03, 0.9), (0.04, 0.75), (0.06, 0.25), (0.22, 0.0)], volume=0.9, wave='noise', pitch=-12, pitch_change=-12)</span>
        <span class="s3"># heal = ursfx([(0.0, 0.0), (0.04, 0.9), (0.08, 0.04), (0.13, 0.66), (0.45, 0.0)], volume=1.0, wave='sine', pitch=-2, pitch_change=4)</span>
        <span class="s3"># coind = ursfx([(0.0, 1.0), (0.07, 0.5), (0.25, 0.5), (0.39, 0.5), (1.0, 0.0)], volume=0.75, wave='sine', pitch=24, speed=2.7)</span>
        <span class="s1">ursfx</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s1">e</span><span class="s2">.</span><span class="s1">get_position</span><span class="s2">(</span><span class="s1">relative_to</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">waveform</span><span class="s2">) </span><span class="s0">for </span><span class="s1">e </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">knobs</span><span class="s2">],</span>
            <span class="s1">volume</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">volume_slider</span><span class="s2">.</span><span class="s1">value</span><span class="s2">,</span>
            <span class="s1">wave</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">wave_selector</span><span class="s2">.</span><span class="s1">value</span><span class="s2">,</span>
            <span class="s1">pitch</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">pitch_slider</span><span class="s2">.</span><span class="s1">value</span><span class="s2">,</span>
            <span class="s1">pitch_change</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">pitch_slider</span><span class="s2">.</span><span class="s1">value </span><span class="s2">+ </span><span class="s1">self</span><span class="s2">.</span><span class="s1">pitch_change_slider</span><span class="s2">.</span><span class="s1">value</span><span class="s2">,</span>
            <span class="s1">speed</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">speed_slider</span><span class="s2">.</span><span class="s1">value</span>
            <span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">code_text</span><span class="s2">.</span><span class="s1">text </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">recipe</span>

<span class="s1">gui </span><span class="s2">= </span><span class="s0">None</span>
<span class="s0">def </span><span class="s1">open_gui</span><span class="s2">():</span>
    <span class="s0">global </span><span class="s1">gui</span>
    <span class="s0">if not </span><span class="s1">gui</span><span class="s2">:</span>
        <span class="s1">gui </span><span class="s2">= </span><span class="s1">UrsfxGUI</span><span class="s2">(</span><span class="s1">enabled</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

        <span class="s0">def </span><span class="s1">toggle_gui_input</span><span class="s2">(</span><span class="s1">key</span><span class="s2">):</span>
            <span class="s0">if </span><span class="s1">key </span><span class="s2">== </span><span class="s5">'f3'</span><span class="s2">:</span>
                <span class="s1">gui</span><span class="s2">.</span><span class="s1">enabled </span><span class="s2">= </span><span class="s0">not </span><span class="s1">gui</span><span class="s2">.</span><span class="s1">enabled</span>
        <span class="s1">Entity</span><span class="s2">(</span><span class="s1">input</span><span class="s2">=</span><span class="s1">toggle_gui_input</span><span class="s2">)</span>
    <span class="s1">gui</span><span class="s2">.</span><span class="s1">enabled </span><span class="s2">= </span><span class="s0">True</span>


<span class="s0">if </span><span class="s1">__name__ </span><span class="s2">== </span><span class="s5">'__main__'</span><span class="s2">:</span>
    <span class="s1">app </span><span class="s2">= </span><span class="s1">Ursina</span><span class="s2">()</span>
    <span class="s1">sfx_editor </span><span class="s2">= </span><span class="s1">UrsfxGUI</span><span class="s2">()</span>
    <span class="s1">Sprite</span><span class="s2">(</span><span class="s5">'shore'</span><span class="s2">, </span><span class="s1">z</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">ppu</span><span class="s2">=</span><span class="s4">64</span><span class="s2">, </span><span class="s1">color</span><span class="s2">=</span><span class="s1">color</span><span class="s2">.</span><span class="s1">gray</span><span class="s2">)</span>
    <span class="s1">app</span><span class="s2">.</span><span class="s1">run</span><span class="s2">()</span>
</pre>
</body>
</html>