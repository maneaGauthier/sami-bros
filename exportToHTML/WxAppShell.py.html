<html>
<head>
<title>WxAppShell.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
.s5 { color: #2aacb8;}
.s6 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
WxAppShell.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; 
WxAppShell provides a GUI application framework using wxPython. 
This is an wxPython version of AppShell.py 
&quot;&quot;&quot;</span>
<span class="s2">import </span><span class="s1">wx</span><span class="s3">, </span><span class="s1">sys</span>

<span class="s2">class </span><span class="s1">WxAppShell</span><span class="s3">(</span><span class="s1">wx</span><span class="s3">.</span><span class="s1">Frame</span><span class="s3">):</span>
    <span class="s1">appversion      </span><span class="s3">= </span><span class="s4">'1.0'</span>
    <span class="s1">appname         </span><span class="s3">= </span><span class="s4">'Generic Application Frame'</span>
    <span class="s1">copyright       </span><span class="s3">= (</span><span class="s4">'Copyright 2008 Walt Disney Internet Group.' </span><span class="s3">+</span>
                       <span class="s4">'</span><span class="s2">\n</span><span class="s4">All Rights Reserved.'</span><span class="s3">)</span>
    <span class="s1">contactname     </span><span class="s3">= </span><span class="s4">'Gyedo Jeon'</span>
    <span class="s1">contactemail    </span><span class="s3">= </span><span class="s4">'Gyedo.Jeon@disney.com'</span>

    <span class="s1">frameWidth      </span><span class="s3">= </span><span class="s5">450</span>
    <span class="s1">frameHeight     </span><span class="s3">= </span><span class="s5">320</span>
    <span class="s1">padx            </span><span class="s3">= </span><span class="s5">5</span>
    <span class="s1">pady            </span><span class="s3">= </span><span class="s5">5</span>
    <span class="s1">usecommandarea  </span><span class="s3">= </span><span class="s5">0</span>
    <span class="s1">usestatusarea   </span><span class="s3">= </span><span class="s5">0</span>
    <span class="s1">balloonState    </span><span class="s3">= </span><span class="s4">'none'</span>
    <span class="s1">panelCount      </span><span class="s3">= </span><span class="s5">0</span>

    <span class="s2">def </span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, *</span><span class="s1">args</span><span class="s3">, **</span><span class="s1">kw</span><span class="s3">):</span>
        <span class="s6"># Initialize the base class</span>
        <span class="s2">if not </span><span class="s1">kw</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s4">''</span><span class="s3">):</span>
            <span class="s1">kw</span><span class="s3">[</span><span class="s4">'title'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">appname</span>
        <span class="s2">if not </span><span class="s1">kw</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s4">'size'</span><span class="s3">):</span>
            <span class="s1">kw</span><span class="s3">[</span><span class="s4">'size'</span><span class="s3">] = </span><span class="s1">wx</span><span class="s3">.</span><span class="s1">Size</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">frameWidth</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">frameHeight</span><span class="s3">)</span>
        <span class="s1">wx</span><span class="s3">.</span><span class="s1">Frame</span><span class="s3">.</span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s2">None</span><span class="s3">, -</span><span class="s5">1</span><span class="s3">, *</span><span class="s1">args</span><span class="s3">, **</span><span class="s1">kw</span><span class="s3">)</span>

        <span class="s1">self</span><span class="s3">.</span><span class="s1">_logWin </span><span class="s3">= </span><span class="s2">None</span>
        <span class="s6"># Initialize the application</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">appInit</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">__createInterface</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">Show</span><span class="s3">()</span>

    <span class="s2">def </span><span class="s1">__createInterface</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">__createLogWin</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">__createMenuBar</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">__createAboutBox</span><span class="s3">()</span>
        <span class="s6"># Add binding for panel cleanup code</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">Bind</span><span class="s3">(</span><span class="s1">wx</span><span class="s3">.</span><span class="s1">EVT_CLOSE</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">quit</span><span class="s3">)</span>
        <span class="s6">#</span>
        <span class="s6"># Create the parts of the interface</span>
        <span class="s6"># which can be modified by subclasses</span>
        <span class="s6">#</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">createMenuBar</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">createInterface</span><span class="s3">()</span>

    <span class="s2">def </span><span class="s1">__createLogWin</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">evt</span><span class="s3">=</span><span class="s2">None</span><span class="s3">):</span>
        <span class="s6"># to bypass wx.Log</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_logWin</span><span class="s3">:</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">_logWin</span><span class="s3">.</span><span class="s1">Destroy</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_logWin </span><span class="s3">= </span><span class="s1">wx</span><span class="s3">.</span><span class="s1">Frame</span><span class="s3">(</span><span class="s2">None</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_logWin</span><span class="s3">.</span><span class="s1">Bind</span><span class="s3">(</span><span class="s1">wx</span><span class="s3">.</span><span class="s1">EVT_CLOSE</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">__createLogWin</span><span class="s3">)</span>
        <span class="s1">wx</span><span class="s3">.</span><span class="s1">Log</span><span class="s3">.</span><span class="s1">SetActiveTarget</span><span class="s3">(</span><span class="s1">wx</span><span class="s3">.</span><span class="s1">LogTextCtrl</span><span class="s3">(</span><span class="s1">wx</span><span class="s3">.</span><span class="s1">TextCtrl</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">_logWin</span><span class="s3">, </span><span class="s1">style</span><span class="s3">=</span><span class="s1">wx</span><span class="s3">.</span><span class="s1">TE_MULTILINE</span><span class="s3">)))</span>

    <span class="s2">def </span><span class="s1">__createMenuBar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">menuBar </span><span class="s3">= </span><span class="s1">wx</span><span class="s3">.</span><span class="s1">MenuBar</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">SetMenuBar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">menuBar</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">__createAboutBox</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">about </span><span class="s3">= </span><span class="s1">wx</span><span class="s3">.</span><span class="s1">MessageDialog</span><span class="s3">(</span><span class="s2">None</span><span class="s3">,</span>
                                      <span class="s1">self</span><span class="s3">.</span><span class="s1">appname </span><span class="s3">+ </span><span class="s4">&quot;</span><span class="s2">\n\n</span><span class="s4">&quot; </span><span class="s3">+</span>
                                      <span class="s4">'Version %s'</span><span class="s3">%</span><span class="s1">self</span><span class="s3">.</span><span class="s1">appversion </span><span class="s3">+ </span><span class="s4">&quot;</span><span class="s2">\n\n</span><span class="s4">&quot; </span><span class="s3">+</span>
                                      <span class="s1">self</span><span class="s3">.</span><span class="s1">copyright </span><span class="s3">+ </span><span class="s4">&quot;</span><span class="s2">\n\n</span><span class="s4">&quot; </span><span class="s3">+</span>
                                      <span class="s4">'For more information, contact:</span><span class="s2">\n</span><span class="s4">%s</span><span class="s2">\n</span><span class="s4">Email: %s' </span><span class="s3">%</span><span class="s1">\</span>
                                      <span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">contactname</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">contactemail</span><span class="s3">),</span>
                                      <span class="s4">&quot;About %s&quot;</span><span class="s3">%</span><span class="s1">self</span><span class="s3">.</span><span class="s1">appname</span><span class="s3">, </span><span class="s1">wx</span><span class="s3">.</span><span class="s1">OK </span><span class="s3">| </span><span class="s1">wx</span><span class="s3">.</span><span class="s1">ICON_INFORMATION</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">showAbout</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">event</span><span class="s3">):</span>
        <span class="s6"># Create the dialog to display about and contact information.</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">about</span><span class="s3">.</span><span class="s1">ShowModal</span><span class="s3">()</span>

    <span class="s2">def </span><span class="s1">quit</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">event</span><span class="s3">=</span><span class="s2">None</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">onDestroy</span><span class="s3">(</span><span class="s1">event</span><span class="s3">)</span>

        <span class="s6"># to close Panda</span>
        <span class="s2">try</span><span class="s3">:</span>
            <span class="s1">base</span>
        <span class="s2">except </span><span class="s1">NameError</span><span class="s3">:</span>
            <span class="s1">sys</span><span class="s3">.</span><span class="s1">exit</span><span class="s3">()</span>

        <span class="s1">base</span><span class="s3">.</span><span class="s1">userExit</span><span class="s3">()</span>

    <span class="s6">### USER METHODS ###</span>
    <span class="s6"># To be overridden</span>
    <span class="s2">def </span><span class="s1">appInit</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># Called before interface is created (should be overridden).</span>
        <span class="s2">pass</span>

    <span class="s2">def </span><span class="s1">createInterface</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># Override this method to create the interface for the app.</span>
        <span class="s2">pass</span>

    <span class="s2">def </span><span class="s1">onDestroy</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">event</span><span class="s3">):</span>
        <span class="s6"># Override this method with actions to be performed on panel shutdown</span>
        <span class="s2">pass</span>

    <span class="s2">def </span><span class="s1">createMenuBar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># Creates default menus.</span>
        <span class="s6"># Override if you don't want to use default menus</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">menuFile </span><span class="s3">= </span><span class="s1">wx</span><span class="s3">.</span><span class="s1">Menu</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">menuBar</span><span class="s3">.</span><span class="s1">Append</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">menuFile</span><span class="s3">, </span><span class="s4">&quot;&amp;File&quot;</span><span class="s3">)</span>

        <span class="s1">self</span><span class="s3">.</span><span class="s1">menuHelp </span><span class="s3">= </span><span class="s1">wx</span><span class="s3">.</span><span class="s1">Menu</span><span class="s3">()</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">menuBar</span><span class="s3">.</span><span class="s1">Append</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">menuHelp</span><span class="s3">, </span><span class="s4">&quot;&amp;Help&quot;</span><span class="s3">)</span>

        <span class="s1">menuItem </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">menuFile</span><span class="s3">.</span><span class="s1">Append</span><span class="s3">(</span><span class="s1">wx</span><span class="s3">.</span><span class="s1">ID_EXIT</span><span class="s3">, </span><span class="s4">&quot;&amp;Quit&quot;</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">Bind</span><span class="s3">(</span><span class="s1">wx</span><span class="s3">.</span><span class="s1">EVT_MENU</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">quit</span><span class="s3">, </span><span class="s1">menuItem</span><span class="s3">)</span>

        <span class="s1">menuItem </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">menuHelp</span><span class="s3">.</span><span class="s1">Append</span><span class="s3">(</span><span class="s1">wx</span><span class="s3">.</span><span class="s1">ID_ABOUT</span><span class="s3">, </span><span class="s4">&quot;&amp;About...&quot;</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">Bind</span><span class="s3">(</span><span class="s1">wx</span><span class="s3">.</span><span class="s1">EVT_MENU</span><span class="s3">, </span><span class="s1">self</span><span class="s3">.</span><span class="s1">showAbout</span><span class="s3">, </span><span class="s1">menuItem</span><span class="s3">)</span>
</pre>
</body>
</html>