<html>
<head>
<title>Inspector.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #cf8e6d;}
.s5 { color: #7a7e85;}
.s6 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Inspector.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot;Inspectors allow you to visually browse through the members of 
various Python objects.  To open an inspector, import this module, and 
execute ``inspector.inspect(anObject)``. 
 
I start IDLE with this command line:: 
 
   idle.py -c &quot;from inspector import inspect&quot; 
 
so that I can just type: ``inspect(anObject)`` any time. 
 
See :ref:`inspection-utilities` for more information. 
&quot;&quot;&quot;</span>


<span class="s1">__all__ </span><span class="s2">= [</span><span class="s3">'inspect'</span><span class="s2">, </span><span class="s3">'inspectorFor'</span><span class="s2">, </span><span class="s3">'Inspector'</span><span class="s2">, </span><span class="s3">'ModuleInspector'</span><span class="s2">, </span><span class="s3">'ClassInspector'</span><span class="s2">, </span><span class="s3">'InstanceInspector'</span><span class="s2">, </span><span class="s3">'FunctionInspector'</span><span class="s2">, </span><span class="s3">'InstanceMethodInspector'</span><span class="s2">, </span><span class="s3">'CodeInspector'</span><span class="s2">, </span><span class="s3">'ComplexInspector'</span><span class="s2">, </span><span class="s3">'DictionaryInspector'</span><span class="s2">, </span><span class="s3">'SequenceInspector'</span><span class="s2">, </span><span class="s3">'SliceInspector'</span><span class="s2">, </span><span class="s3">'InspectorWindow'</span><span class="s2">]</span>

<span class="s4">from </span><span class="s1">direct</span><span class="s2">.</span><span class="s1">showbase</span><span class="s2">.</span><span class="s1">TkGlobal </span><span class="s4">import </span><span class="s2">*</span>
<span class="s4">import </span><span class="s1">Pmw</span>

<span class="s5">### public API</span>

<span class="s4">def </span><span class="s1">inspect</span><span class="s2">(</span><span class="s1">anObject</span><span class="s2">):</span>
    <span class="s0">&quot;&quot;&quot;Opens up a window for visually inspecting the details of a given Python 
    object.  See :ref:`inspection-utilities`. 
    &quot;&quot;&quot;</span>
    <span class="s1">inspector </span><span class="s2">= </span><span class="s1">inspectorFor</span><span class="s2">(</span><span class="s1">anObject</span><span class="s2">)</span>
    <span class="s1">inspectorWindow </span><span class="s2">= </span><span class="s1">InspectorWindow</span><span class="s2">(</span><span class="s1">inspector</span><span class="s2">)</span>
    <span class="s1">inspectorWindow</span><span class="s2">.</span><span class="s1">open</span><span class="s2">()</span>
    <span class="s4">return </span><span class="s1">inspectorWindow</span>

<span class="s5">### private</span>

<span class="s4">def </span><span class="s1">inspectorFor</span><span class="s2">(</span><span class="s1">anObject</span><span class="s2">):</span>
    <span class="s1">typeName </span><span class="s2">= </span><span class="s1">type</span><span class="s2">(</span><span class="s1">anObject</span><span class="s2">).</span><span class="s1">__name__</span><span class="s2">.</span><span class="s1">capitalize</span><span class="s2">() + </span><span class="s3">'Type'</span>
    <span class="s4">if </span><span class="s1">typeName </span><span class="s4">in </span><span class="s1">_InspectorMap</span><span class="s2">:</span>
        <span class="s1">inspectorName </span><span class="s2">= </span><span class="s1">_InspectorMap</span><span class="s2">[</span><span class="s1">typeName</span><span class="s2">]</span>
    <span class="s4">else</span><span class="s2">:</span>
        <span class="s1">print</span><span class="s2">((</span><span class="s3">&quot;Can't find an inspector for &quot; </span><span class="s2">+ </span><span class="s1">typeName</span><span class="s2">))</span>
        <span class="s1">inspectorName </span><span class="s2">= </span><span class="s3">'Inspector'</span>
    <span class="s1">inspector </span><span class="s2">= </span><span class="s1">globals</span><span class="s2">()[</span><span class="s1">inspectorName</span><span class="s2">](</span><span class="s1">anObject</span><span class="s2">)</span>
    <span class="s4">return </span><span class="s1">inspector</span>


<span class="s5">### initializing</span>

<span class="s4">def </span><span class="s1">initializeInspectorMap</span><span class="s2">():</span>
    <span class="s4">global </span><span class="s1">_InspectorMap</span>
    <span class="s1">notFinishedTypes </span><span class="s2">= [</span><span class="s3">'BufferType'</span><span class="s2">,  </span><span class="s3">'EllipsisType'</span><span class="s2">,  </span><span class="s3">'FrameType'</span><span class="s2">, </span><span class="s3">'TracebackType'</span><span class="s2">, </span><span class="s3">'XRangeType'</span><span class="s2">]</span>

    <span class="s1">_InspectorMap </span><span class="s2">= {</span>
        <span class="s3">'Builtin_function_or_methodType'</span><span class="s2">: </span><span class="s3">'FunctionInspector'</span><span class="s2">,</span>
        <span class="s3">'BuiltinFunctionType'</span><span class="s2">: </span><span class="s3">'FunctionInspector'</span><span class="s2">,</span>
        <span class="s3">'BuiltinMethodType'</span><span class="s2">: </span><span class="s3">'FunctionInspector'</span><span class="s2">,</span>
        <span class="s3">'ClassType'</span><span class="s2">: </span><span class="s3">'ClassInspector'</span><span class="s2">,</span>
        <span class="s3">'CodeType'</span><span class="s2">: </span><span class="s3">'CodeInspector'</span><span class="s2">,</span>
        <span class="s3">'ComplexType'</span><span class="s2">: </span><span class="s3">'Inspector'</span><span class="s2">,</span>
        <span class="s3">'DictionaryType'</span><span class="s2">: </span><span class="s3">'DictionaryInspector'</span><span class="s2">,</span>
        <span class="s3">'DictType'</span><span class="s2">: </span><span class="s3">'DictionaryInspector'</span><span class="s2">,</span>
        <span class="s3">'FileType'</span><span class="s2">: </span><span class="s3">'Inspector'</span><span class="s2">,</span>
        <span class="s3">'FloatType'</span><span class="s2">: </span><span class="s3">'Inspector'</span><span class="s2">,</span>
        <span class="s3">'FunctionType'</span><span class="s2">: </span><span class="s3">'FunctionInspector'</span><span class="s2">,</span>
        <span class="s3">'Instance methodType'</span><span class="s2">: </span><span class="s3">'InstanceMethodInspector'</span><span class="s2">,</span>
        <span class="s3">'InstanceType'</span><span class="s2">: </span><span class="s3">'InstanceInspector'</span><span class="s2">,</span>
        <span class="s3">'IntType'</span><span class="s2">: </span><span class="s3">'Inspector'</span><span class="s2">,</span>
        <span class="s3">'LambdaType'</span><span class="s2">: </span><span class="s3">'Inspector'</span><span class="s2">,</span>
        <span class="s3">'ListType'</span><span class="s2">: </span><span class="s3">'SequenceInspector'</span><span class="s2">,</span>
        <span class="s3">'LongType'</span><span class="s2">: </span><span class="s3">'Inspector'</span><span class="s2">,</span>
        <span class="s3">'MethodType'</span><span class="s2">: </span><span class="s3">'FunctionInspector'</span><span class="s2">,</span>
        <span class="s3">'ModuleType'</span><span class="s2">: </span><span class="s3">'ModuleInspector'</span><span class="s2">,</span>
        <span class="s3">'NoneType'</span><span class="s2">: </span><span class="s3">'Inspector'</span><span class="s2">,</span>
        <span class="s3">'SliceType'</span><span class="s2">: </span><span class="s3">'SliceInspector'</span><span class="s2">,</span>
        <span class="s3">'StringType'</span><span class="s2">: </span><span class="s3">'SequenceInspector'</span><span class="s2">,</span>
        <span class="s3">'TupleType'</span><span class="s2">: </span><span class="s3">'SequenceInspector'</span><span class="s2">,</span>
        <span class="s3">'TypeType'</span><span class="s2">: </span><span class="s3">'Inspector'</span><span class="s2">,</span>
         <span class="s3">'UnboundMethodType'</span><span class="s2">: </span><span class="s3">'FunctionInspector'</span><span class="s2">}</span>

    <span class="s4">for </span><span class="s1">each </span><span class="s4">in </span><span class="s1">notFinishedTypes</span><span class="s2">:</span>
        <span class="s1">_InspectorMap</span><span class="s2">[</span><span class="s1">each</span><span class="s2">] = </span><span class="s3">'Inspector'</span>


<span class="s5">### Classes</span>

<span class="s4">class </span><span class="s1">Inspector</span><span class="s2">:</span>
    <span class="s4">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">anObject</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">object </span><span class="s2">= </span><span class="s1">anObject</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">lastPartNumber </span><span class="s2">= </span><span class="s6">0</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">initializePartsList</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">initializePartNames</span><span class="s2">()</span>

    <span class="s4">def </span><span class="s1">__str__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">__name__ </span><span class="s2">+ </span><span class="s3">'(' </span><span class="s2">+ </span><span class="s1">str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">) + </span><span class="s3">')'</span>

    <span class="s4">def </span><span class="s1">initializePartsList</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_partsList </span><span class="s2">= []</span>
        <span class="s1">keys </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">namedParts</span><span class="s2">()</span>
        <span class="s1">keys</span><span class="s2">.</span><span class="s1">sort</span><span class="s2">()</span>
        <span class="s4">for </span><span class="s1">each </span><span class="s4">in </span><span class="s1">keys</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">_partsList</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">each</span><span class="s2">)</span>
            <span class="s5">#if not callable(getattr(self.object, each)):</span>
            <span class="s5">#    self._partsList.append(each)</span>

    <span class="s4">def </span><span class="s1">initializePartNames</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_partNames </span><span class="s2">= [</span><span class="s3">'up'</span><span class="s2">] + [</span><span class="s1">str</span><span class="s2">(</span><span class="s1">each</span><span class="s2">) </span><span class="s4">for </span><span class="s1">each </span><span class="s4">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_partsList</span><span class="s2">]</span>

    <span class="s4">def </span><span class="s1">title</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">&quot;Subclasses may override.&quot;</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">objectType</span><span class="s2">().</span><span class="s1">__name__</span><span class="s2">.</span><span class="s1">capitalize</span><span class="s2">()</span>

    <span class="s4">def </span><span class="s1">getLastPartNumber</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">lastPartNumber</span>

    <span class="s4">def </span><span class="s1">selectedPart</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">partNumber</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">getLastPartNumber</span><span class="s2">())</span>

    <span class="s4">def </span><span class="s1">namedParts</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">dir</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">stringForPartNumber</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">partNumber</span><span class="s2">):</span>
        <span class="s1">object </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">partNumber</span><span class="s2">(</span><span class="s1">partNumber</span><span class="s2">)</span>
        <span class="s1">doc </span><span class="s2">= </span><span class="s4">None</span>
        <span class="s4">if </span><span class="s1">callable</span><span class="s2">(</span><span class="s1">object</span><span class="s2">):</span>
            <span class="s4">try</span><span class="s2">:</span>
                <span class="s1">doc </span><span class="s2">= </span><span class="s1">object</span><span class="s2">.</span><span class="s1">__doc__</span>
            <span class="s4">except</span><span class="s2">:</span>
                <span class="s4">pass</span>
        <span class="s4">if </span><span class="s1">doc</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s2">(</span><span class="s1">str</span><span class="s2">(</span><span class="s1">object</span><span class="s2">) + </span><span class="s3">'</span><span class="s4">\n</span><span class="s3">' </span><span class="s2">+ </span><span class="s1">str</span><span class="s2">(</span><span class="s1">doc</span><span class="s2">))</span>
        <span class="s4">else</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s1">str</span><span class="s2">(</span><span class="s1">object</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">partNumber</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">partNumber</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">lastPartNumber </span><span class="s2">= </span><span class="s1">partNumber</span>
        <span class="s4">if </span><span class="s1">partNumber </span><span class="s2">== </span><span class="s6">0</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span>
        <span class="s4">else</span><span class="s2">:</span>
            <span class="s1">part </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">privatePartNumber</span><span class="s2">(</span><span class="s1">partNumber</span><span class="s2">)</span>
            <span class="s4">return </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">, </span><span class="s1">part</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">inspectorFor</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">part</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">inspectorFor</span><span class="s2">(</span><span class="s1">part</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">privatePartNumber</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">partNumber</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_partsList</span><span class="s2">[</span><span class="s1">partNumber </span><span class="s2">- </span><span class="s6">1</span><span class="s2">]</span>

    <span class="s4">def </span><span class="s1">partNames</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_partNames</span>

    <span class="s4">def </span><span class="s1">objectType</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">type</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">)</span>

<span class="s5">###</span>

<span class="s4">class </span><span class="s1">ModuleInspector</span><span class="s2">(</span><span class="s1">Inspector</span><span class="s2">):</span>
    <span class="s4">def </span><span class="s1">namedParts</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s2">[</span><span class="s3">'__dict__'</span><span class="s2">]</span>

<span class="s4">class </span><span class="s1">ClassInspector</span><span class="s2">(</span><span class="s1">Inspector</span><span class="s2">):</span>
    <span class="s4">def </span><span class="s1">namedParts</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s2">[</span><span class="s3">'__bases__'</span><span class="s2">] + </span><span class="s1">list</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">.</span><span class="s1">__dict__</span><span class="s2">.</span><span class="s1">keys</span><span class="s2">())</span>

    <span class="s4">def </span><span class="s1">title</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">.</span><span class="s1">__name__ </span><span class="s2">+ </span><span class="s3">' Class'</span>

<span class="s4">class </span><span class="s1">InstanceInspector</span><span class="s2">(</span><span class="s1">Inspector</span><span class="s2">):</span>
    <span class="s4">def </span><span class="s1">title</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">.</span><span class="s1">__class__</span><span class="s2">.</span><span class="s1">__name__</span>
    <span class="s4">def </span><span class="s1">namedParts</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s2">[</span><span class="s3">'__class__'</span><span class="s2">] + </span><span class="s1">dir</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">)</span>

<span class="s5">###</span>

<span class="s4">class </span><span class="s1">FunctionInspector</span><span class="s2">(</span><span class="s1">Inspector</span><span class="s2">):</span>
    <span class="s4">def </span><span class="s1">title</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">.</span><span class="s1">__name__ </span><span class="s2">+ </span><span class="s3">&quot;()&quot;</span>

<span class="s4">class </span><span class="s1">InstanceMethodInspector</span><span class="s2">(</span><span class="s1">Inspector</span><span class="s2">):</span>
    <span class="s4">def </span><span class="s1">title</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">.</span><span class="s1">__self__</span><span class="s2">.</span><span class="s1">__class__</span><span class="s2">) + </span><span class="s3">&quot;.&quot; </span><span class="s2">+ </span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">.</span><span class="s1">__name__ </span><span class="s2">+ </span><span class="s3">&quot;()&quot;</span>

<span class="s4">class </span><span class="s1">CodeInspector</span><span class="s2">(</span><span class="s1">Inspector</span><span class="s2">):</span>
    <span class="s4">def </span><span class="s1">title</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">)</span>

<span class="s5">###</span>

<span class="s4">class </span><span class="s1">ComplexInspector</span><span class="s2">(</span><span class="s1">Inspector</span><span class="s2">):</span>
    <span class="s4">def </span><span class="s1">namedParts</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s2">[</span><span class="s3">'real'</span><span class="s2">, </span><span class="s3">'imag'</span><span class="s2">]</span>

<span class="s5">###</span>

<span class="s4">class </span><span class="s1">DictionaryInspector</span><span class="s2">(</span><span class="s1">Inspector</span><span class="s2">):</span>

    <span class="s4">def </span><span class="s1">initializePartsList</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">Inspector</span><span class="s2">.</span><span class="s1">initializePartsList</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">keys </span><span class="s2">= </span><span class="s1">list</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">.</span><span class="s1">keys</span><span class="s2">())</span>
        <span class="s1">keys</span><span class="s2">.</span><span class="s1">sort</span><span class="s2">()</span>
        <span class="s4">for </span><span class="s1">each </span><span class="s4">in </span><span class="s1">keys</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">_partsList</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">each</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">partNumber</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">partNumber</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">lastPartNumber </span><span class="s2">= </span><span class="s1">partNumber</span>
        <span class="s4">if </span><span class="s1">partNumber </span><span class="s2">== </span><span class="s6">0</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span>
        <span class="s1">key </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">privatePartNumber</span><span class="s2">(</span><span class="s1">partNumber</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">key </span><span class="s4">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">[</span><span class="s1">key</span><span class="s2">]</span>
        <span class="s4">else</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">, </span><span class="s1">key</span><span class="s2">)</span>

<span class="s4">class </span><span class="s1">SequenceInspector</span><span class="s2">(</span><span class="s1">Inspector</span><span class="s2">):</span>
    <span class="s4">def </span><span class="s1">initializePartsList</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">Inspector</span><span class="s2">.</span><span class="s1">initializePartsList</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s4">for </span><span class="s1">each </span><span class="s4">in </span><span class="s1">range</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">)):</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">_partsList</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">each</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">partNumber</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">partNumber</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">lastPartNumber </span><span class="s2">= </span><span class="s1">partNumber</span>
        <span class="s4">if </span><span class="s1">partNumber </span><span class="s2">== </span><span class="s6">0</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span>
        <span class="s1">index </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">privatePartNumber</span><span class="s2">(</span><span class="s1">partNumber</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">type</span><span class="s2">(</span><span class="s1">index</span><span class="s2">) == </span><span class="s1">IntType</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">[</span><span class="s1">index</span><span class="s2">]</span>
        <span class="s4">else</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">object</span><span class="s2">, </span><span class="s1">index</span><span class="s2">)</span>

<span class="s4">class </span><span class="s1">SliceInspector</span><span class="s2">(</span><span class="s1">Inspector</span><span class="s2">):</span>
    <span class="s4">def </span><span class="s1">namedParts</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s2">[</span><span class="s3">'start'</span><span class="s2">, </span><span class="s3">'stop'</span><span class="s2">, </span><span class="s3">'step'</span><span class="s2">]</span>


<span class="s5">### Initialization</span>
<span class="s1">initializeInspectorMap</span><span class="s2">()</span>

<span class="s4">class </span><span class="s1">InspectorWindow</span><span class="s2">:</span>
    <span class="s4">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">inspector</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">inspectors </span><span class="s2">= [</span><span class="s1">inspector</span><span class="s2">]</span>

    <span class="s4">def </span><span class="s1">topInspector</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">inspectors</span><span class="s2">[</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">inspectors</span><span class="s2">) - </span><span class="s6">1</span><span class="s2">]</span>

    <span class="s4">def </span><span class="s1">selectedPart</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">topInspector</span><span class="s2">().</span><span class="s1">selectedPart</span><span class="s2">()</span>

    <span class="s4">def </span><span class="s1">inspectedObject</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">topInspector</span><span class="s2">().</span><span class="s1">object</span>

    <span class="s4">def </span><span class="s1">open</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">top</span><span class="s2">= </span><span class="s1">Toplevel</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">top</span><span class="s2">.</span><span class="s1">geometry</span><span class="s2">(</span><span class="s3">'650x315'</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">createViews</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">update</span><span class="s2">()</span>

    <span class="s5">#Private - view construction</span>
    <span class="s4">def </span><span class="s1">createViews</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">createMenus</span><span class="s2">()</span>
        <span class="s5"># Paned widget for dividing two halves</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">framePane </span><span class="s2">= </span><span class="s1">Pmw</span><span class="s2">.</span><span class="s1">PanedWidget</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">top</span><span class="s2">, </span><span class="s1">orient </span><span class="s2">= </span><span class="s1">HORIZONTAL</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">createListWidget</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">createTextWidgets</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">framePane</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">expand </span><span class="s2">= </span><span class="s6">1</span><span class="s2">, </span><span class="s1">fill </span><span class="s2">= </span><span class="s1">BOTH</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">setTitle</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">top</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">'Inspecting: ' </span><span class="s2">+ </span><span class="s1">self</span><span class="s2">.</span><span class="s1">topInspector</span><span class="s2">().</span><span class="s1">title</span><span class="s2">())</span>

    <span class="s4">def </span><span class="s1">createListWidget</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">listFrame </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">framePane</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s3">'list'</span><span class="s2">)</span>
        <span class="s1">listWidget </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">listWidget </span><span class="s2">= </span><span class="s1">Pmw</span><span class="s2">.</span><span class="s1">ScrolledListBox</span><span class="s2">(</span>
            <span class="s1">listFrame</span><span class="s2">, </span><span class="s1">vscrollmode </span><span class="s2">= </span><span class="s3">'static'</span><span class="s2">)</span>
        <span class="s1">listWidget</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">side</span><span class="s2">=</span><span class="s1">LEFT</span><span class="s2">, </span><span class="s1">fill</span><span class="s2">=</span><span class="s1">BOTH</span><span class="s2">, </span><span class="s1">expand</span><span class="s2">=</span><span class="s6">1</span><span class="s2">)</span>
        <span class="s5"># If you click in the list box, take focus so you can navigate</span>
        <span class="s5"># with the cursor keys</span>
        <span class="s1">listbox </span><span class="s2">= </span><span class="s1">listWidget</span><span class="s2">.</span><span class="s1">component</span><span class="s2">(</span><span class="s3">'listbox'</span><span class="s2">)</span>
        <span class="s1">listbox</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s3">'&lt;ButtonPress-1&gt;'</span><span class="s2">,</span>
                        <span class="s4">lambda </span><span class="s1">e</span><span class="s2">, </span><span class="s1">l </span><span class="s2">= </span><span class="s1">listbox</span><span class="s2">: </span><span class="s1">l</span><span class="s2">.</span><span class="s1">focus_set</span><span class="s2">())</span>
        <span class="s1">listbox</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s3">'&lt;ButtonRelease-1&gt;'</span><span class="s2">,  </span><span class="s1">self</span><span class="s2">.</span><span class="s1">listSelectionChanged</span><span class="s2">)</span>
        <span class="s1">listbox</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s3">'&lt;Double-Button-1&gt;'</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">popOrDive</span><span class="s2">)</span>
        <span class="s1">listbox</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s3">'&lt;ButtonPress-3&gt;'</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">popupMenu</span><span class="s2">)</span>
        <span class="s1">listbox</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s3">'&lt;KeyRelease-Up&gt;'</span><span class="s2">,  </span><span class="s1">self</span><span class="s2">.</span><span class="s1">listSelectionChanged</span><span class="s2">)</span>
        <span class="s1">listbox</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s3">'&lt;KeyRelease-Down&gt;'</span><span class="s2">,  </span><span class="s1">self</span><span class="s2">.</span><span class="s1">listSelectionChanged</span><span class="s2">)</span>
        <span class="s1">listbox</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s3">'&lt;KeyRelease-Left&gt;'</span><span class="s2">, </span><span class="s4">lambda </span><span class="s1">e</span><span class="s2">, </span><span class="s1">s </span><span class="s2">= </span><span class="s1">self</span><span class="s2">: </span><span class="s1">s</span><span class="s2">.</span><span class="s1">pop</span><span class="s2">())</span>
        <span class="s1">listbox</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s3">'&lt;KeyRelease-Right&gt;'</span><span class="s2">, </span><span class="s4">lambda </span><span class="s1">e</span><span class="s2">, </span><span class="s1">s </span><span class="s2">= </span><span class="s1">self</span><span class="s2">: </span><span class="s1">s</span><span class="s2">.</span><span class="s1">dive</span><span class="s2">())</span>
        <span class="s1">listbox</span><span class="s2">.</span><span class="s1">bind</span><span class="s2">(</span><span class="s3">'&lt;Return&gt;'</span><span class="s2">,  </span><span class="s1">self</span><span class="s2">.</span><span class="s1">popOrDive</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">createTextWidgets</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">textWidgetsFrame </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">framePane</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s3">'textWidgets'</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">textPane </span><span class="s2">= </span><span class="s1">Pmw</span><span class="s2">.</span><span class="s1">PanedWidget</span><span class="s2">(</span><span class="s1">textWidgetsFrame</span><span class="s2">, </span><span class="s1">orient </span><span class="s2">= </span><span class="s1">VERTICAL</span><span class="s2">)</span>
        <span class="s1">textFrame </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">textPane</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s3">'text'</span><span class="s2">, </span><span class="s1">size </span><span class="s2">= </span><span class="s6">200</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">textWidget </span><span class="s2">= </span><span class="s1">Pmw</span><span class="s2">.</span><span class="s1">ScrolledText</span><span class="s2">(</span>
            <span class="s1">textFrame</span><span class="s2">, </span><span class="s1">vscrollmode </span><span class="s2">= </span><span class="s3">'static'</span><span class="s2">, </span><span class="s1">text_state </span><span class="s2">= </span><span class="s3">'disabled'</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">textWidget</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">fill</span><span class="s2">=</span><span class="s1">BOTH</span><span class="s2">, </span><span class="s1">expand</span><span class="s2">=</span><span class="s6">1</span><span class="s2">)</span>
        <span class="s1">commandFrame </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">textPane</span><span class="s2">.</span><span class="s1">add</span><span class="s2">(</span><span class="s3">'command'</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">commandWidget </span><span class="s2">= </span><span class="s1">Pmw</span><span class="s2">.</span><span class="s1">ScrolledText</span><span class="s2">(</span>
            <span class="s1">commandFrame</span><span class="s2">, </span><span class="s1">vscrollmode </span><span class="s2">= </span><span class="s3">'static'</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">commandWidget</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s6">1.0</span><span class="s2">, </span><span class="s3">'&gt;&gt;&gt; '</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">commandWidget</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">fill </span><span class="s2">= </span><span class="s1">BOTH</span><span class="s2">, </span><span class="s1">expand </span><span class="s2">= </span><span class="s6">1</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">commandWidget</span><span class="s2">.</span><span class="s1">component</span><span class="s2">(</span><span class="s3">'text'</span><span class="s2">).</span><span class="s1">bind</span><span class="s2">(</span>
            <span class="s3">'&lt;KeyRelease-Return&gt;'</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">evalCommand</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">textPane</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">(</span><span class="s1">expand </span><span class="s2">= </span><span class="s6">1</span><span class="s2">, </span><span class="s1">fill </span><span class="s2">= </span><span class="s1">BOTH</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">createMenus</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">menuBar </span><span class="s2">= </span><span class="s1">Menu</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">top</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">top</span><span class="s2">.</span><span class="s1">config</span><span class="s2">(</span><span class="s1">menu</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">menuBar</span><span class="s2">)</span>
        <span class="s1">inspectMenu </span><span class="s2">= </span><span class="s1">Menu</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">menuBar</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">menuBar</span><span class="s2">.</span><span class="s1">add_cascade</span><span class="s2">(</span><span class="s1">label</span><span class="s2">=</span><span class="s3">'Inspect'</span><span class="s2">, </span><span class="s1">menu</span><span class="s2">=</span><span class="s1">inspectMenu</span><span class="s2">)</span>
        <span class="s1">inspectMenu</span><span class="s2">.</span><span class="s1">add_command</span><span class="s2">(</span><span class="s1">label</span><span class="s2">=</span><span class="s3">'Pop'</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">pop</span><span class="s2">)</span>
        <span class="s1">inspectMenu</span><span class="s2">.</span><span class="s1">add_command</span><span class="s2">(</span><span class="s1">label</span><span class="s2">=</span><span class="s3">'Dive'</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">dive</span><span class="s2">)</span>
        <span class="s1">inspectMenu</span><span class="s2">.</span><span class="s1">add_command</span><span class="s2">(</span><span class="s1">label</span><span class="s2">=</span><span class="s3">'Inspect'</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">inspect</span><span class="s2">)</span>
        <span class="s1">helpMenu </span><span class="s2">= </span><span class="s1">Menu</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">menuBar</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">menuBar</span><span class="s2">.</span><span class="s1">add_cascade</span><span class="s2">(</span><span class="s1">label</span><span class="s2">=</span><span class="s3">'Help'</span><span class="s2">, </span><span class="s1">menu</span><span class="s2">=</span><span class="s1">helpMenu</span><span class="s2">)</span>
        <span class="s1">helpMenu</span><span class="s2">.</span><span class="s1">add_command</span><span class="s2">(</span><span class="s1">label</span><span class="s2">=</span><span class="s3">'Instructions'</span><span class="s2">, </span><span class="s1">command</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">showHelp</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">fillList</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">listWidget</span><span class="s2">.</span><span class="s1">delete</span><span class="s2">(</span><span class="s6">0</span><span class="s2">, </span><span class="s1">END</span><span class="s2">)</span>
        <span class="s4">for </span><span class="s1">each </span><span class="s4">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">topInspector</span><span class="s2">().</span><span class="s1">partNames</span><span class="s2">():</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">listWidget</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">END</span><span class="s2">, </span><span class="s1">each</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">listWidget</span><span class="s2">.</span><span class="s1">select_clear</span><span class="s2">(</span><span class="s6">0</span><span class="s2">)</span>

    <span class="s5"># Event Handling</span>
    <span class="s4">def </span><span class="s1">listSelectionChanged</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">event</span><span class="s2">):</span>
        <span class="s1">partNumber </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">selectedIndex</span><span class="s2">()</span>
        <span class="s4">if </span><span class="s1">partNumber </span><span class="s2">== </span><span class="s4">None</span><span class="s2">:</span>
            <span class="s1">partNumber </span><span class="s2">= </span><span class="s6">0</span>
        <span class="s1">string </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">topInspector</span><span class="s2">().</span><span class="s1">stringForPartNumber</span><span class="s2">(</span><span class="s1">partNumber</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">textWidget</span><span class="s2">.</span><span class="s1">component</span><span class="s2">(</span><span class="s3">'text'</span><span class="s2">).</span><span class="s1">configure</span><span class="s2">(</span><span class="s1">state </span><span class="s2">= </span><span class="s3">'normal'</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">textWidget</span><span class="s2">.</span><span class="s1">delete</span><span class="s2">(</span><span class="s3">'1.0'</span><span class="s2">, </span><span class="s1">END</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">textWidget</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">END</span><span class="s2">, </span><span class="s1">string</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">textWidget</span><span class="s2">.</span><span class="s1">component</span><span class="s2">(</span><span class="s3">'text'</span><span class="s2">).</span><span class="s1">configure</span><span class="s2">(</span><span class="s1">state </span><span class="s2">= </span><span class="s3">'disabled'</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">popOrDive</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">event</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot;The list has been double-clicked. If the selection is 'self' then pop, 
        otherwise dive into the selected part&quot;&quot;&quot;</span>
        <span class="s4">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">selectedIndex</span><span class="s2">() == </span><span class="s6">0</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">pop</span><span class="s2">()</span>
        <span class="s4">else</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">dive</span><span class="s2">()</span>

    <span class="s4">def </span><span class="s1">evalCommand</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">event</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot;Eval text in commandWidget&quot;&quot;&quot;</span>
        <span class="s1">insertPt </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">commandWidget</span><span class="s2">.</span><span class="s1">index</span><span class="s2">(</span><span class="s1">INSERT</span><span class="s2">)</span>
        <span class="s1">commandLineStart </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">commandWidget</span><span class="s2">.</span><span class="s1">search</span><span class="s2">(</span>
            <span class="s3">'&gt;&gt;&gt; '</span><span class="s2">, </span><span class="s1">INSERT</span><span class="s2">, </span><span class="s1">backwards </span><span class="s2">= </span><span class="s6">1</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">commandLineStart</span><span class="s2">:</span>
            <span class="s1">commandStart </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">commandWidget</span><span class="s2">.</span><span class="s1">index</span><span class="s2">(</span>
                <span class="s1">commandLineStart </span><span class="s2">+ </span><span class="s3">' + 4 chars'</span><span class="s2">)</span>
            <span class="s1">command </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">commandWidget</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s1">commandStart</span><span class="s2">,</span>
                                             <span class="s1">commandStart </span><span class="s2">+ </span><span class="s3">' lineend'</span><span class="s2">)</span>
            <span class="s4">if </span><span class="s1">command</span><span class="s2">:</span>
                <span class="s1">partDict </span><span class="s2">= { </span><span class="s3">'this'</span><span class="s2">: </span><span class="s1">self</span><span class="s2">.</span><span class="s1">selectedPart</span><span class="s2">(),</span>
                             <span class="s3">'object'</span><span class="s2">: </span><span class="s1">self</span><span class="s2">.</span><span class="s1">topInspector</span><span class="s2">().</span><span class="s1">object </span><span class="s2">}</span>
                <span class="s1">result </span><span class="s2">= </span><span class="s1">eval</span><span class="s2">(</span><span class="s1">command</span><span class="s2">, </span><span class="s1">partDict</span><span class="s2">)</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">commandWidget</span><span class="s2">.</span><span class="s1">insert</span><span class="s2">(</span><span class="s1">INSERT</span><span class="s2">, </span><span class="s1">repr</span><span class="s2">(</span><span class="s1">result</span><span class="s2">) + </span><span class="s3">'</span><span class="s4">\n</span><span class="s3">&gt;&gt;&gt; '</span><span class="s2">)</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">commandWidget</span><span class="s2">.</span><span class="s1">see</span><span class="s2">(</span><span class="s1">INSERT</span><span class="s2">)</span>

    <span class="s5"># Menu Events</span>
    <span class="s4">def </span><span class="s1">inspect</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">inspector </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">inspectorForSelectedPart</span><span class="s2">()</span>
        <span class="s4">if </span><span class="s1">inspector </span><span class="s2">== </span><span class="s4">None</span><span class="s2">:</span>
            <span class="s4">return</span>
        <span class="s1">InspectorWindow</span><span class="s2">(</span><span class="s1">inspector</span><span class="s2">).</span><span class="s1">open</span><span class="s2">()</span>

    <span class="s4">def </span><span class="s1">pop</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">if </span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">inspectors</span><span class="s2">) &gt; </span><span class="s6">1</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">inspectors </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">inspectors</span><span class="s2">[:-</span><span class="s6">1</span><span class="s2">]</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">update</span><span class="s2">()</span>

    <span class="s4">def </span><span class="s1">dive</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">inspector </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">inspectorForSelectedPart</span><span class="s2">()</span>
        <span class="s4">if </span><span class="s1">inspector </span><span class="s2">== </span><span class="s4">None</span><span class="s2">:</span>
            <span class="s4">return</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">inspectors</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">inspector</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">update</span><span class="s2">()</span>

    <span class="s4">def </span><span class="s1">update</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">setTitle</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">fillList</span><span class="s2">()</span>
        <span class="s5"># What is active part in this inspector</span>
        <span class="s1">partNumber </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">topInspector</span><span class="s2">().</span><span class="s1">getLastPartNumber</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">listWidget</span><span class="s2">.</span><span class="s1">select_clear</span><span class="s2">(</span><span class="s6">0</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">listWidget</span><span class="s2">.</span><span class="s1">activate</span><span class="s2">(</span><span class="s1">partNumber</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">listWidget</span><span class="s2">.</span><span class="s1">select_set</span><span class="s2">(</span><span class="s1">partNumber</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">listSelectionChanged</span><span class="s2">(</span><span class="s4">None</span><span class="s2">)</span>
        <span class="s5"># Make sure selected item is visible</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">listWidget</span><span class="s2">.</span><span class="s1">see</span><span class="s2">(</span><span class="s1">partNumber</span><span class="s2">)</span>
        <span class="s5"># Make sure left side of listbox visible</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">listWidget</span><span class="s2">.</span><span class="s1">xview_moveto</span><span class="s2">(</span><span class="s6">0.0</span><span class="s2">)</span>
        <span class="s5"># Grab focus in listbox</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">listWidget</span><span class="s2">.</span><span class="s1">component</span><span class="s2">(</span><span class="s3">'listbox'</span><span class="s2">).</span><span class="s1">focus_set</span><span class="s2">()</span>

    <span class="s4">def </span><span class="s1">showHelp</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">help </span><span class="s2">= </span><span class="s1">Toplevel</span><span class="s2">(</span><span class="s1">tkroot</span><span class="s2">)</span>
        <span class="s1">help</span><span class="s2">.</span><span class="s1">title</span><span class="s2">(</span><span class="s3">&quot;Inspector Help&quot;</span><span class="s2">)</span>
        <span class="s1">frame </span><span class="s2">= </span><span class="s1">Frame</span><span class="s2">(</span><span class="s1">help</span><span class="s2">)</span>
        <span class="s1">frame</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">()</span>
        <span class="s1">text </span><span class="s2">= </span><span class="s1">Label</span><span class="s2">(</span>
            <span class="s1">frame</span><span class="s2">, </span><span class="s1">justify </span><span class="s2">= </span><span class="s1">LEFT</span><span class="s2">,</span>
            <span class="s1">text </span><span class="s2">= </span><span class="s3">&quot;ListBox shows selected object's attributes</span><span class="s4">\n</span><span class="s3">Double click or use right arrow on an instance variable to dive down.</span><span class="s4">\n</span><span class="s3">Double click self or use left arrow to pop back up.</span><span class="s4">\n</span><span class="s3">Use up and down arrow keys to move from item to item in the current level.</span><span class="s4">\n\n</span><span class="s3">Value box (upper right) shows current value of selected item</span><span class="s4">\n\n</span><span class="s3">Command box (lower right) is used to evaluate python commands</span><span class="s4">\n</span><span class="s3">Local variables 'object' and 'this' are defined as the current object being inspected</span><span class="s4">\n</span><span class="s3">and the current attribute selected.&quot;</span>
            <span class="s2">)</span>
        <span class="s1">text</span><span class="s2">.</span><span class="s1">pack</span><span class="s2">()</span>

    <span class="s5">#Private</span>
    <span class="s4">def </span><span class="s1">selectedIndex</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">indices </span><span class="s2">= </span><span class="s1">list</span><span class="s2">(</span><span class="s1">map</span><span class="s2">(</span><span class="s1">int</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">listWidget</span><span class="s2">.</span><span class="s1">curselection</span><span class="s2">()))</span>
        <span class="s4">if </span><span class="s1">len</span><span class="s2">(</span><span class="s1">indices</span><span class="s2">) == </span><span class="s6">0</span><span class="s2">:</span>
            <span class="s4">return None</span>
        <span class="s1">partNumber </span><span class="s2">= </span><span class="s1">indices</span><span class="s2">[</span><span class="s6">0</span><span class="s2">]</span>
        <span class="s4">return </span><span class="s1">partNumber</span>

    <span class="s4">def </span><span class="s1">inspectorForSelectedPart</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">partNumber </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">selectedIndex</span><span class="s2">()</span>
        <span class="s4">if </span><span class="s1">partNumber </span><span class="s2">== </span><span class="s4">None</span><span class="s2">:</span>
            <span class="s4">return None</span>
        <span class="s1">part </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">topInspector</span><span class="s2">().</span><span class="s1">partNumber</span><span class="s2">(</span><span class="s1">partNumber</span><span class="s2">)</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">topInspector</span><span class="s2">().</span><span class="s1">inspectorFor</span><span class="s2">(</span><span class="s1">part</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">popupMenu</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">event</span><span class="s2">):</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s1">event</span><span class="s2">)</span>
        <span class="s1">partNumber </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">selectedIndex</span><span class="s2">()</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s1">partNumber</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">partNumber </span><span class="s2">== </span><span class="s4">None</span><span class="s2">:</span>
            <span class="s4">return</span>
        <span class="s1">part </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">topInspector</span><span class="s2">().</span><span class="s1">partNumber</span><span class="s2">(</span><span class="s1">partNumber</span><span class="s2">)</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s1">part</span><span class="s2">)</span>
        <span class="s4">from </span><span class="s1">panda3d</span><span class="s2">.</span><span class="s1">core </span><span class="s4">import </span><span class="s1">NodePath</span>
        <span class="s4">from </span><span class="s1">direct</span><span class="s2">.</span><span class="s1">fsm </span><span class="s4">import </span><span class="s1">ClassicFSM</span>
        <span class="s1">popupMenu </span><span class="s2">= </span><span class="s4">None</span>
        <span class="s4">if </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">part</span><span class="s2">, </span><span class="s1">NodePath</span><span class="s2">):</span>
            <span class="s1">popupMenu </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">createPopupMenu</span><span class="s2">(</span>
                <span class="s1">part</span><span class="s2">,</span>
                <span class="s2">[(</span><span class="s3">'Explore'</span><span class="s2">, </span><span class="s1">NodePath</span><span class="s2">.</span><span class="s1">explore</span><span class="s2">),</span>
                 <span class="s2">(</span><span class="s3">'Place'</span><span class="s2">, </span><span class="s1">NodePath</span><span class="s2">.</span><span class="s1">place</span><span class="s2">),</span>
                 <span class="s2">(</span><span class="s3">'Set Color'</span><span class="s2">, </span><span class="s1">NodePath</span><span class="s2">.</span><span class="s1">rgbPanel</span><span class="s2">)])</span>
        <span class="s4">elif </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">part</span><span class="s2">, </span><span class="s1">ClassicFSM</span><span class="s2">.</span><span class="s1">ClassicFSM</span><span class="s2">):</span>
            <span class="s4">from </span><span class="s2">. </span><span class="s4">import </span><span class="s1">FSMInspector</span>
            <span class="s1">popupMenu </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">createPopupMenu</span><span class="s2">(</span>
                <span class="s1">part</span><span class="s2">,</span>
                <span class="s2">[(</span><span class="s3">'Inspect ClassicFSM'</span><span class="s2">, </span><span class="s1">FSMInspector</span><span class="s2">.</span><span class="s1">FSMInspector</span><span class="s2">)])</span>
        <span class="s1">print</span><span class="s2">(</span><span class="s1">popupMenu</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">popupMenu</span><span class="s2">:</span>
            <span class="s1">popupMenu</span><span class="s2">.</span><span class="s1">post</span><span class="s2">(</span><span class="s1">event</span><span class="s2">.</span><span class="s1">widget</span><span class="s2">.</span><span class="s1">winfo_pointerx</span><span class="s2">(),</span>
                           <span class="s1">event</span><span class="s2">.</span><span class="s1">widget</span><span class="s2">.</span><span class="s1">winfo_pointery</span><span class="s2">())</span>

    <span class="s4">def </span><span class="s1">createPopupMenu</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">part</span><span class="s2">, </span><span class="s1">menuList</span><span class="s2">):</span>
        <span class="s1">popupMenu </span><span class="s2">= </span><span class="s1">Menu</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">top</span><span class="s2">, </span><span class="s1">tearoff </span><span class="s2">= </span><span class="s6">0</span><span class="s2">)</span>
        <span class="s4">for </span><span class="s1">item</span><span class="s2">, </span><span class="s1">func </span><span class="s4">in </span><span class="s1">menuList</span><span class="s2">:</span>
            <span class="s1">popupMenu</span><span class="s2">.</span><span class="s1">add_command</span><span class="s2">(</span>
                <span class="s1">label </span><span class="s2">= </span><span class="s1">item</span><span class="s2">,</span>
                <span class="s1">command </span><span class="s2">= </span><span class="s4">lambda </span><span class="s1">p </span><span class="s2">= </span><span class="s1">part</span><span class="s2">, </span><span class="s1">f </span><span class="s2">= </span><span class="s1">func</span><span class="s2">: </span><span class="s1">f</span><span class="s2">(</span><span class="s1">p</span><span class="s2">))</span>
        <span class="s4">return </span><span class="s1">popupMenu</span>
</pre>
</body>
</html>